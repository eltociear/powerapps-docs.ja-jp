---
title: IsMatch、Match、および MatchAll 関数 |Microsoft Docs
description: 構文を含む PowerApps の IsMatch、Match、および MatchAll 関数の参照情報
author: gregli-msft
manager: kvivek
ms.service: powerapps
ms.topic: reference
ms.custom: canvas
ms.reviewer: anneta
ms.date: 08/15/2019
ms.author: gregli
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: b9496964b2a11195d3adb561817fec0f9bf11f47
ms.sourcegitcommit: 9163abbe9a24298f216f15139f977adfd2c3f2ae
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/16/2019
ms.locfileid: "69545986"
---
# <a name="ismatch-match-and-matchall-functions-in-powerapps"></a>PowerApps の IsMatch、Match、および MatchAll 関数
パターンに基づいて、一致するかどうかをテストし、テキスト文字列の一部を抽出します。

## <a name="description"></a>説明
**IsMatch** 関数は、通常文字、事前定義済みのパターン、または[正規表現](#regular-expressions)が含まれたパターンにテキスト文字列が一致するかどうかをテストします。  **Match**関数と**matchall**関数は、一致したものを返します (サブマッチを含む)。  

**IsMatch** は、ユーザーが **[テキスト入力](../controls/control-text-input.md)** コントロールに入力した内容を検証するために使用されます。 たとえば、データ ソースに保存する前に、ユーザーが入力した電子メール アドレスが有効かどうかを確認できます。 エントリが基準に一致しない場合、エントリの修正をユーザーに求める他のコントロールを表示します。

**Match**を使用して、パターンに一致する最初のテキスト文字列を抽出し、 **matchall**を使用して一致するすべての文字列を抽出します。 また、サブマッチを抽出して、複雑な文字列を解析することもできます。   

**Match**は、見つかった最初の一致に関する情報のレコードを返します。 **matchall**は、見つかったすべての一致についてレコードのテーブルを返します。 レコードには次のものが含まれます。

| [列] | 種類 | 説明 |
|----|----|----|
| *名前付き&#8209;サブ一致また&#8209;はサブマッチ* | テキスト | 各名前付きサブマッチには、独自の列があります。 (? を使用して名前付きのサブマッチを作成し**ます。&lt;*名前*&gt;** ... **)** を指定します。 名前付きサブ一致の名前が定義済みの列 (下記) のいずれかと同じである場合は、サブマッチが優先され、警告が生成されます。 この警告を回避するには、サブマッチの名前を変更します。 |
| **FullMatch** | テキスト | 一致したすべてのテキスト文字列。 |
| **StartMatch** | 数値 | 入力テキスト文字列内の一致の開始位置。 文字列の最初の文字は1を返します。 | 
| **サブマッチ** | テキストの単一列テーブル (列**値**) | 正規表現に出現する順序での名前付きおよび名前のないサブ一致のテーブル。 一般的に、名前付きのサブマッチは、より簡単に使用でき、推奨されます。 個々のサブマッチを操作するには、 [**ForAll**](function-forall.md)関数または[**Last**](function-first-last.md)( [**firstn**](function-first-last.md)( **...** ) 関数を使用します。 正規表現でサブマッチが定義されていない場合、このテーブルは存在しますが、空になります。 |

これらの関数は、 [**Matchoptions**](#match-options)をサポートしています。 既定では、次のようになります。 
- これらの関数は、大文字と小文字を区別して一致を実行します。 大文字と小文字を区別しない一致を実行するには、 **IgnoreCase**を使用します。    
- **IsMatch**はテキスト文字列全体 (**完全**一致オプション) と一致しますが、 **match**と**matchoption**は、テキスト文字列内の任意の場所 (matchoption を**含む**) を検索します。 シナリオに応じて、 **Complete**、 **Contains**、 **EndsWith** 、また**はを使用**します。

**IsMatch** は、テキスト文字列がパターンに一致する場合は *true* を返し、一致しない場合は *false* を返します。 [**Isblank**](function-isblank-isempty.md)関数を使用してテストできる一致が見つからない場合、 **match**は*空白*を返します。 **Matchall**は、 [**IsEmpty**](function-isblank-isempty.md)関数を使用してテストできる一致が見つからない場合、空のテーブルを返します。

**Matchall**を使用してテキスト文字列を分割する場合は、 **[split](function-split.md)** 関数を使用することをお勧めします。これは、より簡単に使用できるようにするためです。

## <a name="patterns"></a>パターン
これらの関数を使用するための鍵は、一致させるパターンを記述することです。 パターンは、以下を組み合わせたテキスト文字列で記述します。

* 通常文字 ( **"abc"** や **"123"** など)。
* 事前定義済みのパターン (**Letter**、**MultipleDigits**、**Email** など。 これらのパターンは **Match** 列挙型によって定義されます)。
* **"\D + \s + \d +"** や **"[a-z] +"** などの正規表現コード。

これらの要素を結合するには、[文字列 **&** 連結演算子](operators.md)を使用します。 たとえば、 **"abc" & Digit & "\s+"** は有効なパターンであり、後ろに 0 から 9 までの数字と少なくとも 1 つの空白文字が付いた文字 "a"、"b"、"c" に一致します。

### <a name="ordinary-characters"></a>通常文字
最も単純なパターンは、通常文字で構成された文字列です。この場合、パターンと文字列は完全に一致する必要があります。

たとえば、 **IsMatch**関数と共に使用すると、文字列 "hello" はパターン **"hello"** と完全に一致します。 過不足がありません。 文字列 "hello!" は は、末尾に感嘆符があるため、パターンと一致しません。また、大文字と小文字の違いが "h" であるためです。 (この動作を変更する方法については「[MatchOptions](#match-options)」を参照してください)。

パターンの言語では、特別な目的で予約されている文字があります。 これらの文字を使用するには、文字の **\\** 前に (円記号) を付けて、文字が文字どおりに使用されることを示すか、このトピックで後述する定義済みのパターンのいずれかを使用します。 次の表に、特殊文字の一覧を示します。

| 特殊文字 | 説明 |
| --- | --- |
| **.** |ドットまたはピリオド |
| **?** |疑問符 |
| **&#42;** |アスタリスク |
| **\+** |プラス |
| **( )** |内側 |
| **[ ]** |角かっこ |
| **{ }** |中かっこ |
| **^** |キャレット |
| **$** |ドル記号 |
| **\|** |縦棒またはパイプ |
| **\\** |バックスラッシュ |

たとえば、"Hello?" を一致の対象にするには、 疑問符の前にバックスラッシュを付けたパターン **"Hello\\?"** を 使用します。

### <a name="predefined-patterns"></a>事前定義済みのパターン
定義済みのパターンを使用すると、一連の文字または複数の文字のシーケンスのいずれかに簡単に一致させることができます。 [文字列連結演算子 **&** ](operators.md)を使用して、独自のテキスト文字列と**Match**列挙型のメンバーを結合します。

| 一致列挙型 | 説明 | 正規表現 |
| --- | --- | --- |
| **Any** |任意の文字と一致します。 |`.` |
| **Comma** |コンマと一致します。 |`,` |
| **Digit** |1 桁の数と一致します ("0" ～ "9")。 |`\d` |
| **電子メール** |ピリオド (".") が付いたドメイン名と "at" 記号 ("\@") が含まれている電子メール アドレスと一致します |`.+\@.+\\.[^\\.]{2,}` |
| **Hyphen** |ハイフンと一致します。 |`\-` |
| **LeftParen** |左丸かっこ "(" と一致します。 |`\(` |
| **Letter** |1 つの文字と一致します。 |`\p{L}` |
| **MultipleDigits** |1桁以上の数字と一致します。 |`\d+` |
| **MultipleLetters** |1 つ以上の文字と一致します。 |`\p{L}+` |
| **MultipleNonSpaces** |空白 (スペース、タブ、または改行文字ではない) を含まない1つ以上の文字と一致します。 |`\S+` |
| **MultipleSpaces** |空白 (スペース、タブ、または改行) を追加する1つ以上の文字と一致します。 |`\s+` |
| **NonSpace** |空白文字を含まない 1 つの文字と一致します。 |`\S` |
| **OptionalDigits** |0 個の数、または 1 桁以上の数と一致します。 |`\d*` |
| **OptionalLetters** |0 個以上の文字と一致します。 |`\p{L}*` |
| **OptionalNonSpaces** |空白文字を含まない 0 個以上の文字と一致します。 |`\S*` |
| **OptionalSpaces** |空白文字を含む 0 個以上の文字と一致します。 |`\s*` |
| **Period** |ピリオドまたはドット (".") と一致します。 |`\.` |
| **RightParen** |右丸かっこ ")" と一致します。 |`\)` |
| **スペース** |空白文字を含む 1 つの文字と一致します。 |`\s` |

たとえば、パターン **"A" & MultipleDigits** は、後ろに 1 桁以上の数が続く文字 "A" と一致します。  

### <a name="regular-expressions"></a>正規表現
これらの関数が使用するパターンは、[正規表現](https://en.wikipedia.org/wiki/Regular_expression)です。 このトピックで既に説明した通常の文字と定義済みのパターンは、正規表現の作成に役立ちます。  

正規表現は非常に強力で、多数のプログラミング言語に対応しているうえ、さまざまな用途に使用できます。 また、多くの場合、区切り記号のランダムなシーケンスのようになります。 この記事では、正規表現のすべての側面について説明しているわけではありませんが、豊富な情報、チュートリアル、ツールを web で入手できます。  

正規表現はさまざまな言語で使用され、PowerApps は JavaScript 言語のバリアントを使用します。 構文の概要については、「[正規表現の構文](https://msdn.microsoft.com/library/1400241x.aspx)」を参照してください。 名前付きサブ一致 (名前付きキャプチャグループと呼ばれることもあります) は、次のようにサポートされています。

- 名前付きサブマッチ: **(?&lt;*名前*&gt; ...)**
- 名前付き前方参照:  **\\k&lt;*name*&gt;**

このトピックで前に示した列挙型の**照合**テーブルでは、各列挙型は対応する正規表現と同じ行に表示されます。

## <a name="match-options"></a>MatchOptions
これらの関数の動作を変更するには、1つまたは複数のオプションを指定します。これは、文字列 **&amp;** 連結演算子 () を使用して組み合わせることができます。  

| MatchOptions 列挙型 | 説明 | 正規表現への影響 |
| --- | --- | --- |
| **BeginsWith** |パターンはテキストの先頭から一致する必要があります。 |正規表現の先頭に **^** が追加されます。 |
| **Complete** |**IsMatch**の既定値。 パターンは、先頭から末尾までのテキスト文字列全体と一致する必要があります。 |を、正規表現の先頭 **$** と末尾に追加します。 **^** |
| **内容** |**Match**と**matchall**の既定値。 パターンは、テキストの一部と一致する必要がありますが、一致する場所が先頭か末尾である必要はありません。 |正規表現は変更されません。 |
| **EndsWith** |パターンは、テキスト文字列の末尾と一致する必要があります。 |正規表現の末尾に **$** が追加されます。 |
| **IgnoreCase** |大文字と小文字を同一として扱います。 既定では、照合で大文字と小文字が区別されます。 |正規表現は変更されません。 このオプションは、正規表現の標準の "i" 修飾子に相当します。  |
| **Multiline** |複数の行にまたがって照合を実行します。 |正規表現は変更されません。 このオプションは、正規表現の標準の "m" 修飾子に相当します。 |

**Matchall**を使用することは、正規表現に標準の "g" 修飾子を使用することと同じです。

## <a name="syntax"></a>構文
**IsMatch**( *Text*, *Pattern* [, *Options* ] )

* *Text* - 必須。 テストの対象となるテキスト文字列。
* *Pattern* - 必須。 テキスト文字列としてテストするパターン。 **一致**する列挙型で定義されている定義済みのパターンを連結するか、正規表現を指定します。 *パターン*は、変数、データソース、またはアプリの実行時に変更されるその他の動的参照を含まない定数式である必要があります。
* *Options* - 省略可能。 **Matchoptions**列挙値のテキスト文字列の組み合わせ。 既定では **MatchOptions.Complete** が使用されます。

**一致**( *Text*、 *Pattern* [、 *Options* ])

* *Text* - 必須。 照合する文字列。
* *Pattern* - 必須。 テキスト文字列として照合するパターン。 **一致**する列挙型で定義されている定義済みのパターンを連結するか、正規表現を指定します。 *パターン*は、変数、データソース、またはアプリの実行時に変更されるその他の動的参照を含まない定数式である必要があります。
* *Options* - 省略可能。 **Matchoptions**列挙値のテキスト文字列の組み合わせ。 既定では、 **Matchoptions. Contains**が使用されます。

**Matchall**( *Text*、 *Pattern* [、 *Options* ])

* *Text* - 必須。 照合する文字列。
* *Pattern* - 必須。 テキスト文字列として照合するパターン。 **一致**する列挙型で定義されている定義済みのパターンを連結するか、正規表現を指定します。 *パターン*は、変数、データソース、またはアプリの実行時に変更されるその他の動的参照を含まない定数式である必要があります。
* *Options* - 省略可能。 **Matchoptions**列挙値のテキスト文字列の組み合わせ。 既定では、 **Matchoptions. Contains**が使用されます。

## <a name="ismatch-examples"></a>IsMatch の例
### <a name="ordinary-characters"></a>通常文字
ここでは、**TextInput1** という名前の**テキスト入力**コントロールがアプリにあり、 ユーザーがこのコントロールに値を入力すると、それがデータベースに格納されると仮定します。   

今、ユーザーによって **TextInput1** に **Hello world** と入力されています。

| 数式 | 説明 | 結果 |
| --- | --- | --- |
| `IsMatch( TextInput1.Text, "Hello world" )` |ユーザーの入力が文字列 "Hello world" と完全に一致するかどうかをテストします。 |**true** |
| `IsMatch( TextInput1.Text, "Good bye" )` |ユーザーの入力が文字列 "Good bye" と完全に一致するかどうかをテストします。 |**false** |
| `IsMatch( TextInput1.Text, "hello", Contains )` |ユーザーの入力に "hello" という単語が含まれているかどうかをテストします (大文字と小文字は区別されます)。 |**false** |
| `IsMatch( TextInput1.Text, "hello", Contains & IgnoreCase )` |ユーザーの入力に単語 "hello" が含まれているかどうかをテストします (大文字と小文字を区別しない)。 |**true** |

### <a name="predefined-patterns"></a>事前定義済みのパターン

|                                                            数式                                                            |                                                                説明                                                                |  結果   |
|-------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|-----------|
| `IsMatch( "123-45-7890", Digit & Digit & Digit & Hyphen & Digit & Digit & Hyphen & Digit & Digit & Digit & Digit )` |                                              米国の社会保障番号と一致します。                                               | **true**  |
|                                           `IsMatch( "joan@contoso.com", Email )`                                            |                                                         電子メール アドレスと一致します。                                                          | **true**  |
|                              `IsMatch( "123.456", MultipleDigits & Period & OptionalDigits )`                               |                                   一連の数字、ピリオド、0 個以上の数字と一致します。                                   | **true**  |
|                                `IsMatch( "123", MultipleDigits & Period & OptionalDigits )`                                 | 一連の数字、ピリオド、0 個以上の数字と一致します。 一致する文字列にピリオドが表示されないため、このパターンは一致しません。 | **false** |

### <a name="regular-expressions"></a>正規表現

|                                                                              数式                                                                              |                                                                                                                                  説明                                                                                                                                   |  結果   |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------|
|                                                                    `IsMatch( "986", "\d+" )`                                                                   |                                                                                                                    0より大きい整数と一致します。                                                                                                                     | **true**  |
|                                                               `IsMatch( "1.02", "\d+(\.\d\d)?" )`                                                              |                                        正の通貨金額と一致します。 入力に小数点が含まれている場合、入力には小数点の後に2つの数字が含まれている必要があります。 たとえば、3.00 は有効ですが、3.1 は無効です。                                         | **true**  |
|                                                            `IsMatch( "-4.95", "(-)?\d+(\.\d\d)?" )`                                                             |                                                        正または負の通貨金額と一致します。 入力に小数点が含まれている場合、入力には小数点の後に2つの数字が含まれている必要があります。                                                        | **true**  |
|                                                         `IsMatch( "111-11-1111", "\d{3}-\d{2}-\d{4}" )`                                                        | 米国の社会保障番号と一致します。 入力済みの入力フィールドの形式、型、長さを検証します。 照合する文字列は、3つの数字とダッシュ、2つの数字、ダッシュ、4つの数字で構成されている必要があります。 | **true**  |
|                                                         `IsMatch( "111-111-111", "\d{3}-\d{2}-\d{4}" )`                                                         |                                                                                               前の例と同じですが、入力内のハイフンの位置が 1 つ異なります。                                                                                               | **false** |
|                                         `IsMatch( "AStrongPasswordNot", "(?!^[0-9]\*$)(?!^[a-zA-Z]\*$)([a-zA-Z0-9]{8,10})" )`                                        |                                        は、少なくとも1つの数字と1文字以上の英字に加えて、8文字、9文字、または10文字で構成された強力なパスワードを検証します。 この文字列には特殊文字を含めることができません。                                        | **false** |
| `IsMatch( "<http://microsoft.com>", "(ht&#124;f)tp(s?)\:\/\/\[0-9a-zA-Z\]([-.\w]\*[0-9a-zA-Z])\*(:(0-9)\*)\*(\/?)([a-zA-Z0-9\-\.\?\,\'\/\\\+&%\$#_]\*)?" )` |                                                                                                                     http、https、または ftp の URL を検証します。                                                                                                                      | **true**  |

## <a name="match-and-matchall-examples"></a>Match と MatchAll の例

| [数式] | 説明 | 結果 |
|--------|------------|-----------|
| `Match( "Bob Jones <bob.jones@contoso.com>", "<(?<email>" & Match.Email & ")>"` | 連絡先情報の電子メール部分のみを抽出します。  | {<br>電子メール&nbsp;:bob.jones@contoso.com""、<br>Fullmatch:&nbsp;"&lt;bob.jones@contoso.com>",<br>サブマッチ&nbsp;:&nbsp;[bob.jones@contoso.com"&nbsp;],<br>StartMatch:11<br>}  
| `Match( "Bob Jones <InvalidEmailAddress>", "<(?<email>" & Match.Email & ")>"` | 連絡先情報の電子メール部分のみを抽出します。 有効な住所が見つかりません (@ sign はありません)。そのため、関数は*空白*を返します。 | "*空白*" |  
| `Match( Language(), "(<language>\w{2})(?:-(?<script>\w{4}))?(?:-(?<region>\w{2}))?" )` | **[言語関数が](function-language.md)** 返す言語タグの言語、スクリプト、および地域の部分を抽出します。 これらの結果には米国が反映されます。その他の例については、 [**言語**関数のドキュメント](function-language.md)を参照してください。  **(?:** 演算子は、別のサブマッチを作成せずに文字をグループ化します。 | {<br>言語: "en"、<br>スクリプト:*空白*、 <br>リージョン"US"、<br>FullMatch: "en-us", <br>サブマッチ: ["en", "", "US"], <br>StartMatch:1<br>} 
| `Match( "PT2H1M39S", "PT(?:<hours>\d+)H)?(?:(?<minutes>\d+)M)?(?:(?<seconds>\d+)S)?" )` | ISO 8601 duration 値から時間、分、および秒を抽出します。 抽出された数値は、テキスト文字列の中にあります。数値関数を使用して数値演算を実行する前に、その[**値**](function-value.md)を数値に変換します。  | {<br> まで"2"、<br>~"1"、<br>待ち時間"39",<br>FullMatch:"PT2H1M39S",<br>サブマッチ&nbsp;:&nbsp;["2"&nbsp;、"1"&nbsp;、"39&nbsp;"]、<br>StartMatch:1<br>} |

最後の例を掘り下げてみましょう。 **[時刻](function-date-time.md)** 関数を使用してこの文字列を日付/時刻値に変換する場合は、名前付きのサブマッチを個別に渡す必要があります。 これを行うには、**一致**するレコードに対し **[て With](function-with.md)** 関数を使用します。

``` powerapps-dot
With( 
    Match( "PT2H1M39S", "PT(?:(?<hours>\d+)H)?(?:(?<minutes>\d+)M)?(?:(?<seconds>\d+)S)?" ), 
    Time( Value( hours ), Value( minutes ), Value( seconds ) )
)
```

これらの例では、[ボタン](../controls/control-button.md)コントロールを追加し、その**onselect**プロパティを次の数式に設定して、ボタンを選択します。

``` powerapps-dot
Set( pangram, "The quick brown fox jumps over the lazy dog." )
```
 
| [数式] | 説明 | 結果 |
|---------|-------------|--------|
| `Match( pangram, "THE", IgnoreCase )` | **Pangram**変数に含まれるテキスト文字列内の "the" のすべての一致を検索します。 文字列には2つの一致が含まれていますが、 **Match** **all**を使用しているので、最初の値のみが返されます。 サブマッチが定義されていないため、サブマッチ列は空です。  | {<br>FullMatch:"The"、<br>サブマッチ:&nbsp;[]、<br>StartMatch:32<br>} |
| `MatchAll( pangram, "the" )` | **Pangram**変数に含まれるテキスト文字列内の "the" のすべての一致を検索します。 テストでは大文字と小文字が区別されるため、"the" の2番目のインスタンスのみが検出されます。 サブマッチが定義されていないため、サブマッチ列は空です。  | <style> img { max-width: none } </style> ![](media/function-ismatch/pangram-the-one.png) |
| `MatchAll( pangram, "the", IgnoreCase )` | **Pangram**変数に含まれるテキスト文字列内の "the" のすべての一致を検索します。 この場合、テストでは大文字と小文字が区別されないため、単語の両方のインスタンスが検索されます。 サブマッチが定義されていないため、サブマッチ列は空です。  | <style> img { max-width: none } </style> ![](media/function-ismatch/pangram-the-two.png) |
| `MatchAll( pangram, "\b\wo\w\b" )` | 中央に "o" を含む3文字の単語をすべて検索します。 "茶色" は3文字の単語ではなく、"\b" (ワード境界) と一致しないため、除外されることに注意してください。  | <style> img { max-width: none } </style> ![](media/function-ismatch/pangram-fox-dog.png) |
| `Match( pangram, "\b\wo\w\b\s\*(?<between>\w.+\w)\s\*\b\wo\w\b" )` | "Fox" と "dog" の間のすべての文字を検索します。 | {<br>between:&nbsp;"lazy&nbsp;に&nbsp;対する&nbsp;ジャンプ",<br>Fullmatch:&nbsp;"fox&nbsp;&nbsp;は&nbsp;&nbsp;lazydogにジャンプします"&nbsp;,<br>サブマッチ: ["遅延"] にジャンプします。<br>StartMatch:17<br> } |

ギャラリー内の**Matchall**の結果を表示するには、次のようにします。

1. 空の画面で空の垂直方向の挿入 **[ギャラリー](../controls/control-gallery.md)** コントロール。

2. ギャラリーの**Items**プロパティを**matchall (pangram, "\w +")** または**Matchall (pangram, MultipleLetters)** に設定します。

    ![](media/function-ismatch/pangram-gallery1.png)

3. ギャラリーコントロールの中央にある [挿入] タブから [アイテムの追加] を選択し、ギャラリーのテンプレートを選択します。 

5. ギャラリーのテンプレートに **[ラベル](../controls/control-text-box.md)** コントロールを追加します。  

4. ラベルの**Text**プロパティを「この**アイテムの fullmatch**」に設定します。  
 
    ギャラリーには、サンプルのテキスト内の各単語が入力されます。  すべての単語を1つの画面に表示するために、ギャラリーのテンプレートとラベルコントロールのサイズを変更します。

    ![](media/function-ismatch/pangram-gallery2.png)
