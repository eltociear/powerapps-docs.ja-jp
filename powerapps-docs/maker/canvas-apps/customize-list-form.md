---
title: SharePoint リスト フォームのカスタマイズ | Microsoft Docs
description: Power Apps を使用して、SharePoint リストのエントリをユーザーが作成および更新するのに使用するフォームをカスタマイズします。
author: tapanm-msft
manager: kvivek
ms.service: powerapps
ms.topic: conceptual
ms.custom: canvas
ms.reviewer: ''
ms.date: 10/24/2019
ms.author: tapanm
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 73bf91fba403ff1bafb40080426df72e83356dda
ms.sourcegitcommit: c0b694f53af1cd35dce135be9e4e0924ac35608d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/08/2020
ms.locfileid: "3352132"
---
# <a name="customize-a-sharepoint-list-or-library-form-by-using-power-apps"></a>Power Apps を使用して SharePoint リストまたはライブラリのフォームをカスタマイズする

ブラウザーで Power Apps を開いて、SharePoint リストまたは SharePoint ドキュメント ライブラリのフォームを簡単にカスタマイズすることができます。 C# などの従来のコードを記述したり、InfoPath などの別のアプリをダウンロードしたりする必要はありません。 変更を公開すると、すべてのユーザーが使用できるように、SharePoint リスト内にフォームが埋め込まれます。 Power Apps では、分析レポートをレビューしたり、条件付き書式を簡単に作成したり、他のデータ ソースに接続することもできます。

このトピックの手順を行うには、カスタマイズがどのように機能しているかを確認できるように、簡易なリストを作成してから、同じ概念を独自のリストに適用します。

> [!NOTE]
> - 自分のリストで**フォームのカスタマイズ** オプションが使用できない、または正常に動作しない場合は、[Power Apps がサポートしていない](connections/connection-sharepoint-online.md#known-issues)データの種類が含まれている場合があります。 また、フォームを別のリストまたは[環境](working-with-environments.md)に移動することはできません。 
> - リストのカスタム フォームは、汎用リストと汎用ドキュメント ライブラリでのみサポートされています。 カスタム リストとライブラリ テンプレートは現在サポートされていません。お知らせ、連絡先、タスクなどのリストを含みますが、これらに限定されません。
> - ドキュメント ライブラリのカスタム フォームは、カスタム メタデータの編集のみをサポートしています。 ファイルの編集または管理はサポートされていません。

## <a name="create-a-list"></a>リストを作成する

SharePoint サイトでリストを作成し、そのリストに次の列を追加します。

- **詳細** (はい/いいえ)
- **価格** (通貨)
- **使用可能性** (時刻なしの日付)
- **色** (選択)

> [!div class="mx-imgBorder"]
> ![サイトコンテンツ > 新規 > リストを選択し、リスト名を入力して、作成を選択します。 列ごとに、列の追加を選択し、リストの種類 (はい/いいえ、通貨、日付、選択) を指定し、リスト名 (詳細、価格、使用可能性、色) を指定して、保存を選択します。](./media/customize-list-form/create-list.gif)

## <a name="open-the-form"></a>フォームが開く

1. コマンド バーで、**PowerApps** を選択し、次に**フォームのカスタマイズ**を選択します。

    Power Apps Studio が同じブラウザー タブで開きます。

1. **Power Apps Studio へようこそ**のダイアログ ボックスが開いたら、**スキップ**を選択します。

> [!div class="mx-imgBorder"]
> ![コマンド バーで Power Apps を選択し、フォームのカスタマイズを選択します。 Power Apps Studio が同じブラウザー タブで開きます。Power Apps Studio へようこそのダイアログ ボックスが開いたら、スキップを選択します。](./media/customize-list-form/create-form.gif)

## <a name="move-and-remove-a-field"></a>フィールドを移動し削除する

1. **使用可能性**フィールドを、フィールド リストの一番下にドラッグします。

    フィールドは、指定した順序で表示されます。

1. **添付ファイル**のフィールドにカーソルを合わせ、表示される省略記号 (...) を選択してから、**削除**を選択します。

    指定したフィールドがフォームから消えます。

> [!div class="mx-imgBorder"]
> ![使用可能性フィールドを、フィールドリストの一番下にドラッグします。 添付ファイルのフィールドにカーソルを合わせ、表示される省略記号 (...) を選択してから削除を選択します。](./media/customize-list-form/move-remove-fields.gif)

## <a name="set-conditional-formatting"></a>条件付き書式を設定する

**詳細**をはいに設定した場合にのみ、**価格**、**使用可能性**、**色**のフィールドが表示されるように構成できます。

1. 左側のナビゲーション バーで **Details_DataCard1** を展開し、**DataCardValue** の末尾に表示される数字を確認してください。

1. **色**、**使用可能性**、および**価格**カードの **Visible** プロパティをこの式に設定します (必要に応じて、前の手順で確認した数字に置き換えます)。

    **If(DataCardValue2.Value = true, true)**

1. Alt キーを押しながら、**詳細**トグルをクリックまたはタップして、複数回選択します。

    構成した 3 つのフィールドが表示され、フォームから消えます。

> [!div class="mx-imgBorder"]
> ![左側のナビゲーション バーで DataCardValue の末尾に表示される数字を確認してください。 色、使用可能性、価格カードの Visibility プロパティをこの式に設定します。 Alt キーを押しながら、詳細コントロールを複数回選択します。](./media/customize-list-form/conditional-format.gif)

## <a name="save-and-publish-the-form"></a>フォームを保存して公開する

1. **ファイル** メニューを開き、**保存**を選択して **SharePoint に公開**を 2 回選択します。

1. 左上隅で、戻る矢印を選択し、**SharePoint に戻る**を選択します。

> [!div class="mx-imgBorder"]
> ![ファイル メニューを開き、保存を選択して、SharePoint に公開を 2 回選択します。 左上隅で、戻る矢印を選択し、SharePoint に戻るを選択します。](./media/customize-list-form/save-form.gif)

## <a name="further-customize-your-form"></a>フォームをさらにカスタマイズする

1. リストを開き、コマンド バーで**新規**を選択して、フォームの上部にある**カスタマイズ**を選択します。

1. これらのトピックで説明されている方法など、さまざまな方法でフォームをカスタマイズします。

    - サイズ、向き、またはその両方を変更します (例: [フォームの幅を広げる](set-aspect-ratio-portrait-landscape.md))。
    - [1 つ以上のカードをカスタマイズする](working-with-cards.md) (たとえば、カードの表示テキストまたは入力コントロールを変更します)。
    - [検索フィールド](sharepoint-lookup-fields.md)を作成します。

    詳細: [SharePoint フォームの統合について](sharepoint-form-integration.md)。

## <a name="use-the-default-form"></a>既定のフォームを使用する

1. SharePoint でリストから (右上隅の歯車アイコンを選択して) 設定ページを開き、**リストの設定**を選択します。

2. **全般設定**の下で、**フォームの設定**を選択します。

3. **フォームの設定**ページで、これらのオプションのいずれかを選択し、**OK** を選択します。

    - **既定の SharePoint フォームを使用する** - ユーザーがリストを開き、コマンド バーで**新規**を選択すると、そのリストの既定のフォームが表示されます。

    - **Power Apps で作成されたカスタム フォームを使用する** - ユーザーがリストを開き、コマンド バーで**新規**を選択すると、カスタム フォームが表示されます。 (または、Power Apps でフォームをもう一度発行することもできます。)

    これらのオプションは、必要に応じて切り替えることができます。

    ![フォームの設定オプション](./media/customize-list-form/form-settings.png)

## <a name="delete-the-custom-form"></a>カスタム フォームの削除

1. SharePoint でリストから (右上隅の歯車アイコンを選択して) 設定ページを開き、**リストの設定**を選択します。

1. **全般設定**の下で、**フォームの設定**を選択します。

1. **フォームの設定**ページで、**既存の SharePoint フォームを使用する**を選択し、**カスタム フォームの削除**を選択します。

    ![カスタム フォームの削除](./media/customize-list-form/use-default-sharepoint.png)

## <a name="q--a"></a>Q & A

### <a name="forms-vs-apps"></a>フォームとアプリ

**Q:** カスタマイズしたフォームは、SharePoint または Power Apps から作成したスタンドアロンのアプリとどう違いますか。

**A:** SharePoint リストのフォームをカスタマイズする場合、Power Apps Studio または Power Apps Mobile ではフォームがアプリとして表示されません。 フォームは、それを作成したリストからのみ開くことができます。

**Q:** SharePoint リスト内のデータを管理するためのフォームをカスタマイズする必要があるのは、どのような場合ですか。また、スタンドアロン アプリを作成する必要があるのはどのような場合ですか。

**A:** ユーザーが SharePoint を離れることなく、(たとえばデスクトップ ブラウザーなどで) データを管理できるようにする場合は、フォームをカスタマイズします。 ユーザーが SharePoint の外部で (たとえばモバイル デバイスなどで) データを管理できるようにする場合は、アプリを作成します。

**Q:** フォームをカスタマイズして、同じリストのアプリを作成することはできますか?

**A:** はい。

**Q:** リストをカスタマイズして、同じ機能のアプリを作成できますか?

**A:** はい。

**Q:** 組織の既定環境以外の環境でフォームをカスタマイズできますか?

**A:** いいえ。

### <a name="manage-your-custom-form"></a>カスタム フォームを管理する

**Q:** 自分のフォームを他のユーザーと簡単に共有するにはどうすればよいですか?

**A:** フォームを開き、**リンクのコピー**を選択し、フォームを使用するユーザーにリンクを送信します。

**Q:** 他のユーザーに対して変更を可視にせずに、フォームを更新できますか?

**A:** はい。 フォームの変更と保存は何度でもできますが、変更内容は **SharePoint に公開**を 2 回選択するまで他のユーザーには表示されません。

**Q:** リスト フォームのカスタマイズを間違えた場合は、以前のバージョンに戻すことができますか?

**A:** はい。

1. リストを開き、コマンド バーで **PowerApps** を選択し、**フォームをカスタマイズ**を選択します。

1. Power Apps Studio で、**ファイル**、**すべてのバージョンの表示**の順に選択します。 **バージョン** ページが新しいブラウザー タブに表示されます。

    > [!NOTE]
    > **すべてのバージョンの表示**ボタンが表示されていない場合は、**保存**を選択します。 ボタンが表示されます。

1. **バージョン** ページまたはブラウザー タブを閉じずに、他のブラウザー タブの**保存**ページに戻って、左側のナビゲーション ウィンドウの上部にある矢印をクリックまたはタップします。次に、**SharePoint に戻る**をクリックまたはタップしてフォームのロックを解除し、Power Apps Studio を閉じます。

1. ブラウザー タブの**バージョン** ページに戻り、復元するバージョンを見つけて、**復元** を選択します。

    > [!NOTE]
    > フォームが別のユーザーによってロックされているために復元が失敗したというエラー メッセージが表示された場合は、そのユーザーがフォームのロックを解除するまで待機してからやり直してください。

**Q:** リスト間でフォームを移動できますか?

**A:** いいえ。

### <a name="administer-your-custom-form"></a>カスタム フォームを管理する

**Q:** フォームを共有する方法を教えてください。

**A:** フォームを共有する必要はありません。フォームは、SharePoint リストからアクセス許可を継承します。 フォームのカスタマイズが完了したら、他のユーザーが使用できるように[そのフォームを SharePoint に公開する](customize-list-form.md#save-and-publish-the-form)だけです。

**Q:** 誰がフォームをカスタマイズできますか?

**A:** 関連リストを管理、設計、または編集する SharePoint アクセス許可を持つ任意のユーザーです。

**Q:** カスタム リスト フォームの作成や使用に、Power Apps のライセンスは必要ですか?

**A:** [Power Apps を含む Office 365 プラン](https://docs.microsoft.com/power-platform/admin/pricing-billing-skus#licenses)が必要です。

**Q:** ゲスト ユーザーがカスタム フォームを含むリストにアクセスするとどうなりますか?

**A:** ゲスト ユーザーが Power Apps を使用してカスタマイズされているリスト フォームにアクセスしようとすると、エラー メッセージが表示されます。

**Q:** 管理者が、組織のすべてのカスタマイズされたフォーム一覧を取得する方法を教えてください。

**A:** Power Apps のテナント管理者であるか、組織の既定の Power Apps 環境に対する環境管理者アクセス許可を持っている場合は、次のように操作します。

1. [Power Apps 管理センター](https://admin.powerapps.com)で、環境のリストから、組織の既定の環境を選択します。

1. 既定の環境のページ上部で、**リソース**を選択します。

1. アプリのリストから、アプリの種類が **SharePoint フォーム**のアプリを探します。これらは、カスタマイズされたフォームです。

    ![カスタマイズされたフォームのリスト](./media/customize-list-form/all-customized-forms.png)
