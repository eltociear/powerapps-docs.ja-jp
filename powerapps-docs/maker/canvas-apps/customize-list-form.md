---
title: SharePoint リスト フォームのカスタマイズ | Microsoft Docs
description: PowerApps を使用して、SharePoint リストのエントリをユーザーが作成および更新するのに使用するフォームをカスタマイズします。
author: tapanm-msft
manager: kvivek
ms.service: powerapps
ms.topic: conceptual
ms.custom: canvas
ms.reviewer: ''
ms.date: 10/24/2019
ms.author: tapanm
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: d50d9933eaaa79011a623bc643f4eda23ba8d745
ms.sourcegitcommit: fa6ad01cf6d025d46564d755915caaa9db517c41
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/25/2019
ms.locfileid: "72902415"
---
# <a name="customize-a-sharepoint-list-form-by-using-powerapps"></a>PowerApps を使用した SharePoint リスト フォームのカスタマイズ

SharePoint リスト フォームは、ブラウザーで PowerApps を開くことで簡単にカスタマイズすることができます。 C# などの従来のコードを記述したり、InfoPath などの別のアプリをダウンロードしたりする必要はありません。 変更を発行すると、すべてのユーザーが使用できるように、SharePoint リスト内にフォームが埋め込まれます。 PowerApps では、分析レポートを確認したり、条件付き書式を簡単に作成したり、他のデータ ソースに接続することもできます。

このトピックの手順を行うには、カスタマイズがどのように機能しているかを確認できるように、単純なリストを作成してから、同じ概念を独自のリストに適用できます。

> [!NOTE]
> - 自分のリストで **[フォームのカスタマイズ]** オプションが使用できない、または正常に動作しない場合は、[PowerApps がサポートしない](connections/connection-sharepoint-online.md#known-issues)データ型が含まれている場合があります。 また、フォームを別のリストまたは[環境](working-with-environments.md)に移動することはできません。 
> - リストのカスタムフォームは、ジェネリックリストでのみサポートされています。 汎用ドキュメントライブラリのサポートは近日対応予定です。 カスタムリストとライブラリテンプレートは現在サポートされていません。お知らせ、連絡先、タスクなどの一覧を含めますが、限定することはできません。

## <a name="create-a-list"></a>リストを作成する

SharePoint サイトでリストを作成し、次の列をそのリストに追加します。

- **詳細** (はい/いいえ)
- **価格** (通貨)
- **利用可能** (時刻なしの日付)
- **色** (選択)

> [!div class="mx-imgBorder"]
> [サイトのコンテンツ > 新しい > リストを選択 ![には、リスト名を入力し、[作成] を選択します。 列ごとに、[列の追加] を選択し、リストの種類 ([はい]/[いいえ]、[通貨]、[日付]、[選択]) を指定して、リスト名 (詳細、価格、利用可能、色) を指定し、[保存] を選択します。](./media/customize-list-form/create-list.gif)

## <a name="open-the-form"></a>フォームを開く

1. コマンドバーで **[PowerApps]** を選択し、 **[フォームのカスタマイズ]** を選択します。

    同じブラウザー タブに PowerApps Studio が開きます。

1. **[PowerApps Studio へようこそ]** ダイアログ ボックスが開いたら、 **[スキップ]** を選びます。

> [!div class="mx-imgBorder"]
> ![、コマンドバーで [PowerApps] を選択し、[フォームのカスタマイズ] を選択します。 PowerApps Studio 同じブラウザータブで開きます。[PowerApps Studio の開始] ダイアログボックスが表示されたら、[スキップ] を選択します。](./media/customize-list-form/create-form.gif)

## <a name="move-and-remove-a-field"></a>フィールドの移動と削除

1. **[可用性]** フィールドをフィールドの一覧の一番下にドラッグします。

    フィールドは指定した順序で表示されます。

1. **[添付ファイル]** フィールドの上にマウスポインターを移動し、表示される省略記号 (...) を選択して、 **[削除]** を選択します。

    指定したフィールドがフォームに表示されなくなります。

> [!div class="mx-imgBorder"]
> [可用性] フィールドをフィールドの一覧の一番下にドラッグ ![ます。 [添付ファイル] フィールドの上にマウスポインターを移動し、表示される省略記号 (...) を選択して、[削除] を選択します。](./media/customize-list-form/move-remove-fields.gif)

## <a name="set-conditional-formatting"></a>条件付き書式を設定する

**[詳細]** を [はい] に設定した場合にのみ、 **[価格]** 、 **[利用可能]** 、 **[色]** のフィールドが表示されるように構成できます。

1. 左側のナビゲーションバーで **[Details_DataCard1]** を展開し、 **Datacシャー**ドの値の最後に表示される数字を書き留めます。

1. **Color**、 **Availability**、および**Price**の各カードの**Visible**プロパティを次の数式に設定します (必要に応じて、前の手順でメモした数字を置き換えます)。

    **If (DataCardValue2 = true, true)**

1. Alt キーを押しながら、 **[詳細]** トグルをクリックまたはタップして、複数回選択します。

    構成した 3 つのフィールドが表示され、フォームから消えます。

> [!div class="mx-imgBorder"]
> ![左側のナビゲーションバーで、Datacシャード値の最後に表示される数字を確認します。 色、使用可能、および価格カードの [可視性] プロパティをこの数式に設定します。 Alt キーを押したまま、詳細コントロールを複数回選択します。](./media/customize-list-form/conditional-format.gif)

## <a name="save-and-publish-the-form"></a>フォームを保存して発行する

1. **[ファイル]** メニューを開き、 **[保存]** を選択し、 **[SharePoint に発行]** を 2 回選択します。

1. 左上隅で、戻る矢印を選択し、 **[SharePoint に戻る]** を選択します。

> [!div class="mx-imgBorder"]
> ![[ファイル] メニューの [保存] をクリックし、[SharePoint に発行] を2回クリックします。 左上隅にある [戻る] 矢印をクリックし、[SharePoint に戻る] を選択します。](./media/customize-list-form/save-form.gif)

## <a name="further-customize-your-form"></a>フォームをさらにカスタマイズする

1. 一覧を開き、コマンドバーの **[新規]** を選択し、フォームの上部近くにある **[カスタマイズ]** を選択します。

1. 次のトピックで説明するように、さまざまな方法でフォームをカスタマイズします。

    - サイズ、向き、またはその両方を変更する (例: [フォームの幅を広げる](set-aspect-ratio-portrait-landscape.md))。
    - [1 つまたは複数のカードをカスタマイズ](working-with-cards.md)します (たとえば、カードの表示テキストや入力コントロールを変更します)。
    - [ルックアップ フィールド](sharepoint-lookup-fields.md)を作成する。

    詳細: [SharePoint フォームの統合](sharepoint-form-integration.md)について説明します。

## <a name="use-the-default-form"></a>既定のフォームを使用する

1. SharePoint でリストから (右上隅の歯車アイコンを選んで) 設定ページを開き、 **[リストの設定]** を選択します。

2. **[全般設定]** の下で **[フォームの設定]** を選択します。

3. **[フォームの設定]** ページで、これらのオプションのいずれかを選択し、 **[OK]** を選択します。

    - **既定の SharePoint フォームを使用する**: ユーザーがリストを開き、コマンド バーで **[新規]** を選択すると、そのリストの既定のフォームが表示されます。

    - **Use a custom form created in PowerApps \(PowerApps で作成されたカスタム フォームを使用する\)** : ユーザーがリストを開き、コマンド バーで **[新規]** を選択すると、カスタム フォームが表示されます (または、PowerApps でフォームをもう一度発行することもできます)。

    これらのオプションは、必要に応じて切り替えることができます。

    ![[フォームの設定] オプション](./media/customize-list-form/form-settings.png)

## <a name="delete-the-custom-form"></a>カスタム フォームの削除

1. SharePoint でリストから (右上隅の歯車アイコンを選んで) 設定ページを開き、 **[リストの設定]** を選択します。

1. **[全般設定]** の下で **[フォームの設定]** を選択します。

1. **[フォームの設定]** ページで、 **[既定の SharePoint フォームを使用する]** を選択し、 **[Delete custom form]\(カスタム フォームの削除\)** を選択します。

    ![カスタム フォームの削除](./media/customize-list-form/use-default-sharepoint.png)

## <a name="q--a"></a>Q & A

### <a name="forms-vs-apps"></a>フォームとアプリ

**Q:** カスタマイズしたフォームは、SharePoint または PowerApps から作成したスタンドアロンのアプリとどう違うのですか?

**A:** SharePoint リストのフォームをカスタマイズする場合、PowerApps Studio または PowerApps Mobile でフォームがアプリとして表示されません。 フォームは、それを作成したリストからのみ開くことができます。

**Q:** SharePoint リスト内のデータを管理するためのフォーをカスタマイズする必要があるのは、どのような場合ですか? また、スタンドアロン アプリを作成する必要があるのはどのような場合ですか?

**A:** ユーザーが SharePoint を離れることなく、(たとえばデスクトップ ブラウザーなどで) データを管理できるようにする場合は、フォームをカスタマイズします。 ユーザーが SharePoint の外部で (たとえばモバイル デバイスなどで) データを管理できるようにする場合は、アプリを作成します。

**Q:** フォームをカスタマイズし、同じリストのアプリを作成できますか?

**A:** はい。

**Q:** リストをカスタマイズし、同じ機能のアプリを作成できますか?

**A:** はい。

**Q:** 所属組織の既定の環境以外の環境でフォームをカスタマイズできますか?

**A:** いいえ。

### <a name="manage-your-custom-form"></a>カスタム フォームを管理する

**Q:** 自分のフォームを他のユーザーと簡単に共有するにはどうすればよいですか?

**A:** フォームを開き、 **[リンクのコピー]** を選択して、フォームを使用するすべてのユーザーにリンクを送信します。

**Q:** 他のユーザーに変更を見せずに、フォームを更新できますか?

**A:** はい。 フォームの変更と保存は何度でもできますが、変更内容は **[SharePoint に発行]** を 2 回選択するまで他のユーザーには表示されません。

**Q:** リスト フォームをカスタマイズしたけれど間違えた場合は、以前のバージョンに戻すことができますか?

**A:** はい。

1. リストを開き、コマンド バーで **[PowerApps]** を選択し、 **[フォームをカスタマイズ]** を選択します。

1. PowerApps Studio で、 **[ファイル]** 、 **[すべてのバージョンの表示]** の順に選択します。 **[バージョン]** ページが新しいブラウザー タブに表示されます。

    > [!NOTE]
    > **[すべてのバージョンの表示]** ボタンが表示されていない場合は、 **[保存]** を選択します。 ボタンが表示されるはずです。

1. **[バージョン]** ページ (つまり、ブラウザー タブ) を閉じずに、元のブラウザー タブの **[保存]** ページに戻って、左側のナビゲーション ウィンドウの上部にある矢印をクリックまたはタップします。次に、 **[SharePoint に戻る]** をクリックまたはタップしてフォームのロックを解除し、PowerApps Studio を閉じます。

1. さきほどのブラウザー タブの **[バージョン]** ページに戻り、復元するバージョンを見つけて、 **[復元]** を選択します。

    > [!NOTE]
    > フォームが別のユーザーによってロックされているために復元が失敗したというエラーメッセージが表示された場合は、ユーザーがフォームのロックを解除するまで待ってから、もう一度やり直してください。

**Q:** リスト間でフォームを移動できますか?

**A:** いいえ。

### <a name="administer-your-custom-form"></a>カスタム フォームを管理する

**Q:** フォームを共有する方法を教えてください

**A:** フォームを共有する必要はありません。フォームは、SharePoint リストからアクセス許可を継承します。 フォームのカスタマイズが完了したら、他のユーザーが使用できるように[そのフォームを SharePoint に発行しなおす](customize-list-form.md#save-and-publish-the-form)だけです。

**Q:** フォームをカスタマイズできるのは誰ですか?

**A:** 関連リストを管理、設計、または編集する SharePoint アクセス許可を持つ任意のユーザーです。

**Q:** カスタム リスト フォームの作成や使用に、PowerApps のライセンスは必要ですか?

**A:** [PowerApps を含む Office 365 プラン](https://docs.microsoft.com/power-platform/admin/pricing-billing-skus#licenses)が必要です。

**Q:** ゲスト ユーザーがカスタム フォームを含むリストにアクセスするとどうなりますか?

**A:** ゲスト ユーザーが PowerApps を使用してカスタマイズされているリスト フォームにアクセスしようとすると、エラー メッセージが表示されます。

**Q:** 管理者が所属組織のすべてのカスタマイズされたフォームのリストを取得する方法を教えてください。

**A:** PowerApps のテナント管理者であるか、組織の既定の PowerApps 環境に対する環境管理者アクセス許可を持っている場合は、次のように操作します。

1. [PowerApps 管理センター](https://admin.powerapps.com)で、環境のリストから、組織の既定の環境を選択します。

1. 既定の環境のページ上部で、 **[リソース]** を選択します。

1. アプリの一覧から、 **SharePoint フォーム**アプリの種類のアプリを探します。これらはカスタマイズされたフォームです。

    ![カスタマイズされたフォームのリスト](./media/customize-list-form/all-customized-forms.png)
