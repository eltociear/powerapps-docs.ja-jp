---
title: キャンバス アプリで依存のドロップダウン リストを作成する | Microsoft Docs
description: Power Apps で、キャンバス アプリで別のドロップダウン リストをフィルターするドロップダウン リストを作成します。
author: emcoope-msft
manager: kvivek
ms.service: powerapps
ms.topic: conceptual
ms.custom: canvas
ms.reviewer: tapanm
ms.date: 04/04/2019
ms.author: emcoope
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 500154ecde380a1cf339f934728807216d29c804
ms.sourcegitcommit: 6b27eae6dd8a53f224a8dc7d0aa00e334d6fed15
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/03/2019
ms.locfileid: "3305694"
---
# <a name="create-dependent-drop-down-lists-in-a-canvas-app"></a>キャンバス アプリで依存のドロップダウン リストを作成する

依存 (またはカスケード) ドロップダウン リストを作成すると、ユーザーはリストのオプションを選択して、別のリストのオプションをフィルター処理します。 多くの組織では、ユーザーがフォームに効率よく記入できるように依存リストを作成しています。 たとえば、ユーザーは国または地域を選択して都市のリストをフィルター処理したり、カテゴリを選択してそのカテゴリのコードのみを表示したりできます。

ベスト プラクティスとして、ユーザーがアプリを使用して更新するデータ ソースとは別に、「親」リストと「子」リストの値 (国/地域、都市など) のデータ ソースを作成します。 このアプローチを採用すると、複数のアプリで同じ親データと子データを使用でき、それらを使用するアプリを再公開せずにそのデータを更新できます。 コレクションまたは静的データを使用して同じ結果を得ることができますが、企業向けのシナリオにはお勧めできません。

このトピックのシナリオでは、店舗の従業員がフォームを介して**インシデント** リストに問題を送信します。 従業員は、インシデントが発生した店舗の場所だけでなく、その場所の部署も指定します。 すべての場所に同じ部署があるわけではないため、**場所**リストを使用すると、従業員はその部署のない場所には部署を指定できなくなります。

このトピックでは、データ ソースとして Microsoft SharePoint リストを使用していますが、すべての表形式のデータ ソースは同じように機能します。

## <a name="create-data-sources"></a>データ ソースの作成

**場所**リストには、各場所の部署が表示されます。

| 場所 | 課 |
|----------------|------------------|
| イーガンビル      | ベーカリー           |
| イーガンビル      | デリ             |
| イーガンビル      | 生成          |
| レンフルー        | ベーカリー           |
| レンフルー        | デリ             |
| レンフルー        | 生成          |
| レンフルー        | 薬局         |
| レンフルー        | フローラル           |
| ペンブローク       | ベーカリー           |
| ペンブローク       | デリ             |
| ペンブローク       | 生成          |
| ペンブローク       | フローラル           |

**インシデント** リストには、連絡先情報と各インシデントに関する情報が表示されます。 日付列を**日付**列として作成し、その他の列は**1 行テキスト**列として作成して構成を簡素化し、Microsoft Power Apps での[委任](./delegation-overview.md)の警告を回避します。

| 名 | 姓 | 電話番号     | 場所 | 課 | 内容       | Date      |
|------------|-----------|------------------|----------------|------------|-------------------------|-----------|
| トーニャ       | コルテス   | (206) 555 - 1022 | イーガンビル      | 生成    | 問題が発生しました …   | 2/12/2019 |
| モーセ     | ラフラム     | (425) 555 - 1044 | レンフルー        | フローラル     | 問題が発生しました … | 2/13/2019 |

既定では、カスタム SharePoint リストには**タイトル**列が含まれており、名前を変更したり削除したりすることはできません。リストにアイテムを保存するには、その列にデータが含まれている必要があります。 データを必要としないように列を構成するには:

1. 右上の歯車アイコンを選択して、**リストの設定** を選択します。
1. **設定**ページで、列のリストにある**タイトル**を選択します。
1. **この列への情報の入力を必須にする**で、**いいえ**を選択します。

その変更後、**タイトル**列を無視するか、少なくとも 1 つの他の列が表示されている既定のビューから[それを削除](https://support.office.com/article/edit-a-list-column-in-sharepoint-online-77130c2e-76d1-4f80-af8b-4c6f47b264b8)できます。

## <a name="open-the-form"></a>フォームが開く

1. **インシデント** リストを開き、**PowerApps** > **フォームのカスタマイズ**を選択します。

    > [!div class="mx-imgBorder"]
    > ![インシデント リストを開き、Power Apps > フォームのカスタマイズを選択します。](./media/dependent-drop-down-lists/open-form.png "インシデント リストを開き、Power Apps > フォームのカスタマイズを開きます。")

    ブラウザーのタブが開き、既定のフォームが Power Apps Studio で開きます。

1. (オプション) **フィールド** ウィンドウで、**タイトル** フィールドにカーソルを合わせ、表示される省略記号 (...) を選択してから、**削除**を選択します。

    **フィールド** ウィンドウを閉じている場合は、左側のナビゲーション バーで **SharePointForm1** を選択し、右側のウィンドウにある**プロパティ** タブで**フィールドの編集**を選択します。

1. (オプション) 前の手順を繰り返して、フォームから**添付ファイル** フィールドを削除します。

    追加したフィールドのみがフォームに表示されます。

    > [!div class="mx-imgBorder"]
    > ![タイトルと添付ファイル フィールドのないフォーム](./media/dependent-drop-down-lists/default-form.png)

## <a name="replace-the-controls"></a>コントロールを置き換える

1. **フィールド** ウィンドウで、**場所**の横にある矢印を選択します。

    **フィールド** ウィンドウを閉じている場合は、左側のナビゲーション バーで **SharePointForm1** を選択し、右側のウィンドウにある**プロパティ** タブで**フィールドの編集**を選択します。

1. **コントロールの種類**のリストを開き、**許容値**を選択します。

    > [!div class="mx-imgBorder"]
    > ![許容値](./media/dependent-drop-down-lists/change-control.png)

    入力メカニズムが**ドロップ ダウン** コントロールに変更されます。

1. **部署**カードに対してこれらの手順を繰り返します。

## <a name="add-the-locations-list"></a>場所リストを追加する

1. **ビュー** > **データ ソース** > **データ ソースを追加**を選択します。

1. SharePoint 接続を選択または作成し、**場所**リストを含むサイトを指定します。

1. そのリストのチェック ボックスをオンにしてから、**接続**を選択します。

    > [!div class="mx-imgBorder"]
    > ![データ ウィンドウ](./media/dependent-drop-down-lists/select-list.png)

    接続リストには、フォームの基となる**インシデント** リストと、フォームの場所と部署を識別する**場所**リストが表示されます。

    > [!div class="mx-imgBorder"]
    > ![SharePoint データ ソース](./media/dependent-drop-down-lists/data-sources.png)

## <a name="unlock-the-cards"></a>カードのロックを解除する

1. **場所**カードを選択し、右側のウィンドウで**詳細設定**のタブを選択して、**ロックを解除してプロパティを変更する**を選択します。

1. **部署**カードに対してこの手順を繰り返します。

## <a name="rename-the-controls"></a>コントロールの名前を変更する

コントロールの名前を変更すると、コントロールをより簡単に識別できるようになり、例に従うのが容易になります。 他のベスト プラクティスを見つけるには、[コーディング標準とガイドラインのホワイトペーパー](https://aka.ms/powerappscanvasguidelines)をレビューしてください。

1. **場所**のカードで、**ドロップ ダウン** コントロールを選択します。

1. 右側のウィンドウ上部で、**ddLocation** と入力するか貼り付けを行って、選択したコントロールの名前を変更します。

    > [!div class="mx-imgBorder"]
    > ![コントロール名の変更](./media/dependent-drop-down-lists/rename-control.png)

1. **部署**カードで前の 2 つの手順を繰り返して、**ドロップ ダウン** コントロールの名前を **ddDepartment** に変更します。

## <a name="configure-the-locations"></a>場所の構成

1. **ddlocation** の **Items** プロパティを、この数式に設定します。

    `Distinct(Locations, Location)`

1. (オプション) Alt キーを押しながら **ddLocation** を開き、リストに 3 つの場所が表示されていることを確認します。

## <a name="configure-the-departments"></a>部署の構成

1. **ddDepartment** を選択して、右側のウィンドウの**プロパティ** タブで、**依存**を選択します。

1. **親コントロール**で、**ddLocation** が上のリストに表示され、**Result** が下のリストに表示されることを確認してください。

    > [!NOTE]
    > 文字列ではなく、実際の ID で照合する場合は、**Result** ではなく、**ID** を選択します。

1. **一致するフィールド**で、上のリストにある**場所**と下のリストにある**場所**を選択し、**適用**を選択します。

    > [!div class="mx-imgBorder"]
    > ![リンクに依存](./media/dependent-drop-down-lists/depends-on.png)

    **ddDepartment** の **Items** プロパティを次の数式に設定します。

    `Filter(Locations, Location = ddLocation.Selected.Result)`

    この式は、ユーザーが **ddLocation** で選択した内容に基づいて、**ddDepartment** の項目をフィルター処理します。 このような構成により、SharePoint の**場所**リストに指定されているように、部署の「子」リストが「親」の場所のデータを確実に反映します。

1. 右側のウィンドウの**プロパティ** タブで、**値**の横にあるリストを開いてから、**部署**を選択します。

    このステップでは、SharePoint の**場所**リストの**部署**列のオプションに、表示テキストを設定します。

    > [!div class="mx-imgBorder"]
    > ![部署の値](./media/dependent-drop-down-lists/dept-value.png)

## <a name="test-the-form"></a>フォームをテストする

Alt キーを押しながら、場所のリストを開いて 1 つ選択し、部署のリストを開いて 1 つ選択します。

場所と部署のリストは、SharePoint の**場所**リストの情報を反映しています。

> [!div class="mx-imgBorder"]
> ![場所のリストを開き、選択をレンフルーからペンブロークに変更してから、部署のリストを開く](./media/dependent-drop-down-lists/dropdowns.gif)

## <a name="save-and-open-the-form-optional"></a>フォームを開き保存する (オプション)

1. **ファイル** メニューを開き、**保存** > **SharePoint に公開** > **SharePoint に公開**を選択します。

1. 左上隅で、戻る矢印を選択し、**SharePoint に戻る**を選択します。

1. コマンド バーで **新規**を選択し、カスタマイズしたフォームを開きます。

## <a name="faq"></a>よくあるご質問

**データが表示されません。ソースがすべて空白であるか、データが間違っています。**
次のいずれかの方法で、コントロールの正しいフィールドを表示しているかどうかを確認します。

- ドロップダウン リストを選択し、右側のウィンドウの**プロパティ** タブで、**Value** プロパティを選択します。

    > [!div class="mx-imgBorder"]
    > ![ドロップ ダウンを変更する](./media/dependent-drop-down-lists/drop-down-display-field.png)

- コンボ ボックスを選択し、プライマリ テキストが表示するフィールドであることを確認します。

    > [!div class="mx-imgBorder"]
    > ![コンボ ボックスを変更する](./media/dependent-drop-down-lists/combo-box-display-field.png)

**子のドロップダウン リストに重複した項目が含まれています。**
この症状は、SharePoint の**ルックアップ**列、または Power Apps の **Choices** 関数を使用したことが原因です。 重複を削除するには、正しく返されるデータを **Distinct** 関数でラップします。 詳細については、[Distinct 関数](functions/function-distinct.md)を参照してください。

## <a name="known-limitations"></a>既知の制限

この構成は、**ドロップ ダウン** コントロール、**コンボ ボックス**、および**リスト ボックス** コントロールで使用でき、一度に 1 つ選択できます。 **依存**構成は、複数の選択を許可する場合、これらのコントロールのいずれにも使用できません。 この方法は、Common Data Service のオプション セットを使用して作業する場合にはお勧めしません。

**依存**構成は静的データまたはコレクションをサポートしていません。 これらのソースを使用して依存ドロップダウン リストを構成するには、数式バーで直接式を編集します。 さらに Power Apps は、一致するデータのテーブルがない SharePoint では、2 つの選択フィールドの使用をサポートしていません。そしてこの UI 内で**一致するフィールド**を定義することはできません。
