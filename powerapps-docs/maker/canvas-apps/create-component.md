---
title: キャンバスアプリのコンポーネントを作成する |Microsoft Docs
description: キャンバスアプリの再利用可能なコンポーネントの概要
author: yifwang
ms.service: powerapps
ms.topic: article
ms.date: 12/12/2018
ms.author: yifwang
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 857ca2c78da5b3a7ced4d4d09dfb335fab02d47c
ms.sourcegitcommit: dd2a8a0362a8e1b64a1dac7b9f98d43da8d0bd87
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/02/2019
ms.locfileid: "74678697"
---
# <a name="create-a-component-for-canvas-apps"></a>キャンバスアプリ用のコンポーネントを作成する

> [!IMPORTANT]
> この機能は引き続き試験段階であり、既定では無効になっています。 詳細については、「[試験機能とプレビュー機能](working-with-experimental.md)」を参照してください。

コンポーネントは、アプリの開発者がアプリまたはアプリで使用するカスタムコントロールを作成できるように、キャンバスアプリの再利用可能な構成要素です。 カスタムプロパティなどの高度な機能により、コンポーネントの複雑な機能が有効になります。 この記事では、コンポーネントの概念といくつかの例について説明します。

コンポーネントは、類似したコントロールパターンを持つ大規模なアプリを構築する場合に役立ちます。 コンポーネント定義を更新すると、アプリ内のすべてのインスタンスに変更が反映されます。 また、コントロールをコピーして貼り付けるのではなく、オーバーヘッドが重複するため、1つ以上のコンポーネントを使用してパフォーマンスを向上させることもできます。 また、コンポーネントは共同開発を促進し、組織内のルックアンドフィールを標準化します。

## <a name="prerequisite"></a>前提条件

**[アプリの設定]** 画面を開き、 **[詳細設定]** を選択して機能を有効にします。さらに、強化された**アプリのレンダリング**も有効にします。

## <a name="component-canvas"></a>コンポーネントキャンバス

左側のナビゲーションバーでは、 **[挿入]** タブの **[コンポーネント]** メニューまたは次の図に示すように、コンポーネントを作成できます。 この一覧には、アプリで定義されたコンポーネントが、作成時刻順に並べ替えて表示されます。

![コンポーネントリストビュー](./media/create-component/list-view.png)

どの方法を使用するかにかかわらず、空のキャンバスが表示され、コンポーネント定義の一部としてコントロールを追加できます。 キャンバスでコンポーネントを編集する場合は、他のアプリ画面や他のアプリで同じコンポーネントのインスタンスを更新します。

画面を選択した場合は、左側のナビゲーションバーまたは **[挿入]** タブの **[コンポーネント]** メニューで、既存のコンポーネントの一覧からコンポーネントを選択できます。コンポーネントを選択すると、コントロールを挿入するのと同様に、コンポーネントのインスタンスが画面に挿入されます。

## <a name="scope"></a>適用範囲

コンポーネントは、インターフェイスとしてプロパティを持つカプセル化されたブラックボックスと考えることができます。 コンポーネントの外部からコンポーネント内のコントロールにアクセスすることはできません。コンポーネント内からコンポーネントの外部にあるものを参照することはできません。 試行すると、エラーが表示されます。 スコープの制限により、コンポーネントのデータコントラクトをシンプルかつまとまったものに保ち、特にアプリ間でシームレスなコンポーネント定義の更新を可能にします。 コンポーネントのデータコントラクトを更新するには、1つまたは複数のカスタムプロパティを作成します。

## <a name="variables"></a>環境

コンポーネントは**Updatecontext**関数をサポートしていませんが、 **Set**関数を使用して、コンポーネントの変数を作成および更新できます。 これらの変数のスコープはコンポーネントに限定されますが、カスタム出力プロパティを利用してコンポーネントの外部からアクセスすることができます。

## <a name="import-and-export"></a>インポートとエクスポート

1つ以上のコンポーネントを1つのアプリから別のアプリにインポートするには、コンポーネントのドロップダウンリストで **[コンポーネントのインポート]** を選択します。 ダイアログボックスには、編集権限のあるコンポーネントが含まれているすべてのアプリが一覧表示されます。 アプリを選択し、 **[インポート]** を選択して、そのアプリ内のすべてのコンポーネントの最新の公開バージョンをインポートします。 少なくとも1つのコンポーネントをインポートしたら、必要のないコピーを編集して削除することができます。

> [!div class="mx-imgBorder"]
> ![コンポーネントのインポート ダイアログボックス](./media/create-component/import-components.png)

コンポーネントをエクスポートする場合は、別のアプリにインポートできるローカルファイルを作成します。 同じコンポーネントの変更バージョンがアプリに含まれている場合は、変更されたバージョンを置き換えるか、インポートをキャンセルするかを決定するように求められます。 

## <a name="custom-properties"></a>カスタムプロパティ

1つ以上のカスタムプロパティを作成すると、コンポーネントは入力値を受け取り、データを出力できます。 これらのシナリオは高度なものであり、数式やバインドコントラクトについて理解する必要があります。

入力プロパティは、コンポーネントがコンポーネントで使用するデータを受け取る方法を示します。 コンポーネントのインスタンスが選択されている場合、右側のペインの **[プロパティ]** タブに入力プロパティが表示されます。 他のコントロールで標準プロパティを構成する場合と同様に、式または数式を使用して入力プロパティを構成できます。 その他のコントロールには、**テキスト入力**コントロールの**既定**のプロパティなどの入力プロパティがあります。

出力プロパティは、データまたはコンポーネントの状態を出力できます。 たとえば、**ギャラリー**コントロールで**選択された**プロパティは、出力プロパティです。 出力プロパティを作成するときに、コンポーネントの状態を参照できる他のコントロールを指定できます。

このチュートリアルでは、これらの概念について詳しく説明します。

## <a name="create-an-example-component"></a>サンプルコンポーネントの作成

この例では、このグラフィックに似たメニューコンポーネントを作成します。ここでは、テキストを変更し、複数の画面、アプリ、またはその両方で使用できます。

![最終ギャラリー](./media/create-component/menu-instance.png)

1. Power Apps Studio で、空のアプリを作成します。

1. 左側のナビゲーションバーで、コンポーネントの一覧を開き、 **[新しいコンポーネント]** を選択します。

    ![コンポーネントの一覧](./media/create-component/component-list.png)

1. 新しいコンポーネントの上にカーソルを合わせて、省略記号ボタン (...) を選択し、**名前の変更** を選択して、 **menucomponent**を入力するか貼り付けます。

1. 右側のウィンドウで、コンポーネントの 幅] を **[150]** 、[高さ を**250**に設定し、 **[新しいカスタムプロパティ]** を選択します。

    ![新しいプロパティ](./media/create-component/new-property.png)

1. **[表示名]** 、 **[プロパティ名**]、 **[説明]** の各ボックスに、**項目**を入力するか貼り付けます。

    ![表示名、プロパティ名、説明ボックス](./media/create-component/property-names.png)

    プロパティ名を指定する場合は、数式を記述するときにこの名前でコンポーネントを参照するので、スペースを含めないでください (たとえば、 **ComponentName**)。

    コンポーネントを選択すると、右側のウィンドウの **[プロパティ]** タブに表示名が表示されます。 わかりやすい表示名は、このプロパティの目的を理解するのに役立ちます。 **[プロパティ]** タブでこのプロパティの表示名をポイントすると、ツールヒントに**説明**が表示されます。

1. **[データ型]** ボックスの一覧で **[テーブル]** を選択し、 **[作成]** を選択します。

    ![プロパティのデータ型](./media/create-component/property-data-type.png)

    **Items**プロパティは、指定したデータ型に基づいて既定値に設定されますが、必要に応じて値を設定することもできます。 **テーブル**または**レコード**のデータ型を指定した場合は、コンポーネントに入力するデータスキーマと一致するように**Items**プロパティの値を変更することができます。 この場合は、文字列のリストに変更します。

    右側のペインの **[プロパティ]** タブでプロパティの名前を選択した場合は、数式バーでプロパティの値を設定できます。

    ![[プロパティ] タブのカスタム入力プロパティ](./media/create-component/properties-tab.png)

    次の図に示すように、右側のウィンドウの **[詳細設定**] タブでプロパティの値を編集することもできます。

1. コンポーネントの**Items**プロパティを次の数式に設定します。

    ```powerapps-dot
    Table({Item:"SampleText"})
    ```

    ![数式](./media/create-component/set-component-items.png)

1. コンポーネントで、空の垂直**ギャラリー**コントロールを挿入します。

1. プロパティリストに**Items**プロパティが表示されていることを確認し (既定では)、そのプロパティの値を次の式に設定します。

    ```powerapps-dot
    MenuComponent.Items
    ```

    このようにして、**ギャラリー**コントロールの**items**プロパティは、コンポーネントの**items** input プロパティを読み取って依存します。

1. **ギャラリー**コントロールの **[borderthickness]** プロパティを**1**に設定し、その**templatesize**プロパティを**50**に設定します。

1. **ギャラリー**コントロールのテンプレートで、**ラベル**コントロールを追加します。

    ![ラベルの追加とギャラリーの境界の設定](./media/create-component/add-label.png)

次に、コンポーネントを画面に追加し、表示するコンポーネントの文字列のテーブルを指定します。

1. 左側のナビゲーションバーで、画面の一覧を選択し、既定の画面を選択します。

    ![既定の画面](./media/create-component/default-screen.png)

1. **[挿入]** タブで、 **[コンポーネント]** メニューを開き、 **[menucomponent]** を選択します。

    ![Insert](./media/create-component/insert.png)

    新しいコンポーネントには、既定で**MenuComponent_1**という名前が付けられます。

1. **MenuComponent_1**の**Items**プロパティを次の数式に設定します。

    ```powerapps-dot
    Table({Item:"Home"}, {Item:"Admin"}, {Item:"About"}, {Item:"Help"})
    ```

    このインスタンスはこのグラフィックに似ていますが、各インスタンスのテキストおよびその他のプロパティをカスタマイズできます。

    ![最終ギャラリー](./media/create-component/menu-instance.png)

ここまでで、コンポーネントを作成してアプリに追加しました。 次に、ユーザーがメニューで選択した項目を反映する出力プロパティを作成します。

1. コンポーネントの一覧を開き、 **[Menucomponent]** を選択します。

1. 右側のウィンドウで、 **[プロパティ]** タブを選択し、 **[新しいカスタムプロパティ]** を選択します。

1. **[表示名]** 、 **[プロパティ名**]、 **[説明]** の各ボックスに、「 **Selected**」と入力するか貼り付けます。

1. **[プロパティの種類]** で **[出力]** を選択し、 **[作成]** を選択します。

1. [**詳細**設定] タブで、**選択した**プロパティの値を次の式に設定します。必要に応じて、ギャラリー名の数字を調整します。

    ```powerapps-dot
    Gallery1.Selected.Item
    ```

    ![[詳細設定] ウィンドウ](./media/create-component/advance.png)

1. アプリの既定の画面で、ラベルを追加し、 **Text**プロパティを次の式に設定します。必要に応じて、コンポーネント名の数字を調整します。

    ```powerapps-dot
    MenuComponent_1.Selected
    ```

    **MenuComponent_1**は、コンポーネント定義の名前ではなく、インスタンスの既定の名前であることに注意してください。 任意のインスタンスの名前を変更できます。

1. Alt キーを押しながら、メニューの各項目を選択します。

    **ラベル**コントロールには、最近選択したメニュー項目が反映されます。

## <a name="known-limitations"></a>既知の制限

- このドキュメントの作成時点では、データソースはコンポーネントと共に保存されないため、フォームとデータテーブルは無効になります。
- Power Apps はコンポーネントのコレクションをサポートしていません。
- コンポーネントをギャラリー、フォーム、またはデータカードに挿入することはできません。
- コンポーネントのマスターインスタンスはローカルマスターで、アプリにスコープが設定されています。 マスターインスタンスを変更すると、アプリ内のコンポーネントのコピーだけが変更を反映します。 コンポーネントライブラリを再度インポートしない限り、他のアプリのコピーは同じままです。 これらのアプリのすべてのマスターインスタンスが自動的に検出され、更新されます。
- コンポーネントをインポートするときに、メディアファイルをパッケージ化することはできません。
