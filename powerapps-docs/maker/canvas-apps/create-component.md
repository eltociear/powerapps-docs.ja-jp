---
title: キャンバス アプリ用コンポーネントの作成 | Microsoft Docs
description: キャンバス アプリ用の再利用可能なコンポーネントの概要
author: yifwang
ms.service: powerapps
ms.topic: article
ms.date: 04/24/2020
ms.author: yifwang
ms.reviewer: tapanm
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: d8159ec80d007aca0ae90b316f4ee2c5d5693741
ms.sourcegitcommit: 943672dad0041d3bab25b44cd8c4d25e88f39b93
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/25/2020
ms.locfileid: "3309535"
---
# <a name="create-a-component-for-canvas-apps"></a>キャンバス アプリ用コンポーネントの作成

> [!IMPORTANT]
> この機能は、まだパブリック プレビューにあります。 詳細については [実験的機能とプレビュー機能](working-with-experimental.md) を参照してください。

コンポーネントはキャンバス アプリの再利用可能なビルディング ブロックであるため、アプリ メーカーは [コンポーネント ライブラリ](component-library.md) を使用してアプリ内でまたはアプリ間で使用するカスタム コントロールを作成できます。 コンポーネントは、カスタム プロパティなどの高度な機能を使用して、複雑な機能を有効にすることができます。 この記事では、コンポーネントの概念およびサンプルを紹介します。

コンポーネントは、類似したコントロール パターンを持つ大きなアプリを作成するのに役立ちます。 アプリ内のコンポーネント定義を更新すると、アプリ内のすべてのインスタンスに変更が反映されます。 コンポーネントは、コントロールのコピーや貼り付けの必要性を排除し、パフォーマンスを改善することにより、工数の重複を減らします。 また、コンポーネントは [コンポーネント ライブラリ](component-library.md) の使用時に共同開発を作成し、組織内でのルック アンド フィールを標準化するのに役立ちます。

## <a name="components-in-canvas-apps"></a>キャンバス アプリのコンポーネント

この記事で説明するようにアプリ内から、また [コンポーネント ライブラリ](component-library.md) 内で新しいコンポーネントを作成することにより、コンポーネントを作成することができます。 コンポーネント ライブラリは、複数のアプリ画面間でコンポーネントを使用する要件のために使用する必要があります。 また、既存のコンポーネントを既存の、または新しいコンポーネント ライブラリにコピーすることもできます。

アプリ内でコンポーネントを作成するには、**ツリー表示**に移動し、**コンポーネント** タブを選択し、次に**新しいコンポーネント**を選択します。

![ツリー ビューを使用して新しいカスタム コンポーネントを作成する](./media/create-component/insert-new-component-treeview.png "ツリー ビューを使用して新しいカスタム コンポーネントを作成する")

**新しいコンポーネント**を選択して空のキャンバスを開きます。 キャンバスのコンポーネント定義の一部としてコントロールを追加できます。 キャンバスでコンポーネントを編集する場合、他のアプリ画面の同じコンポーネントのインスタンスが更新されます。 すでに作成されたコンポーネントを再利用するアプリは、コンポーネントの変更を公開した後にコンポーネントの更新を受け取ることもできます。

画面を選択した後、左側のナビゲーションにある既存のコンポーネントのリストからコンポーネントを選択することができます。 コンポーネントを選択すると、コントロールを挿入するように、そのコンポーネントのインスタンスが画面に挿入されます。

アプリ内で利用可能なコンポーネントは、ツリー ビュー内のコンポーネント リストの**カスタム** カテゴリの下に一覧表示されます。 コンポーネント ライブラリからインポートされたコンポーネントは、**ライブラリ コンポーネント** カテゴリーの下に一覧表示されます。

![アプリにコンポーネントを挿入する](./media/create-component/insert-components.png "アプリにコンポーネントを挿入する")

> [!NOTE]
> この記事で説明するコンポーネントは、開発者およびメーカーがモデル駆動型アプリおよびキャンバス アプリ用のコード コンポーネントを作成できるようにする Power Apps component framework とは異なります。 詳細については、[Power Apps component framework の概要](https://docs.microsoft.com/powerapps/developer/component-framework/overview)。

## <a name="scope"></a>Scope

コンポーネントを、インターフェイスとしてのプロパティを持つカプセル化されたブラック ボックスと考えます。 コンポーネントの外部から、コンポーネント内のコントロールにアクセスすることはできません。 また、コンポーネントの内部からコンポーネントの外部を参照することはできません。 例外は、アプリとそのコンポーネント間で共有されるデータ ソースです。 スコープの制限により、コンポーネントのデータ コントラクトは単純でまとまりがあるものになり、コンポーネント ライブラリのあるアプリ間でコンポーネント定義の更新を有効にするのに役立ちます。 1 つ以上のカスタム プロパティを作成することにより、コンポーネントのデータ コントラクトを更新できます。

> [!NOTE]
> コンポーネントのインスタンスをコンポーネント ライブラリ内の画面に挿入し、テスト目的でその画面をプレビューできます。 また、[Power Apps モバイル](https://powerapps.microsoft.com/downloads/) の使用時には、コンポーネント ライブラリは表示されません。

## <a name="custom-properties"></a>カスタム プロパティ

1 つ以上のカスタム プロパティを作成すると、コンポーネントは入力値を受け取り、データを発行できます。 これらのシナリオは高度であり、[式](formula-reference.md) およびコントラクトのバインドについて理解している必要があります。

**Input プロパティ**は、コンポーネントで使用するデータをコンポーネントが受け取る方法です。 Input プロパティは、コンポーネントのインスタンスが選択されている場合、右側のウィンドウの**プロパティ** タブに表示されます。 他のコントロールの標準プロパティを構成する場合と同様に、式または計算式を使用して入力プロパティを構成できます。 その他のコントロールには、**テキスト入力**コントロールの**既定**プロパティなど、入力プロパティがあります。

**Output プロパティ**はデータまたはコンポーネントの状態を発行するために使用されます。 たとえば、**ギャラリー** コントロールの**選択済み**上のプロパティは出力プロパティです。 出力プロパティを作成するとき、その他のどのコントロールがコンポーネントの状態を参照できるか確認できます。

次に、これらの概念についてさらに説明します。

## <a name="create-an-example-component"></a>コンポーネントの例の作成

この例では、次の図に似たメニュー コンポーネントを作成します。 後でテキストを変更して、複数の画面、アプリ、またはその両方で使用することもできます。

![最終ギャラリー](./media/create-component/menu-instance-new.png "最終ギャラリー")

> [!NOTE]
> 再利用するコンポーネントを作成するとき、[コンポーネント ライブラリ](component-library.md) を使用することをお勧めします。 アプリ内でコンポーネントを更新した場合、コンポーネントの更新はアプリ内で利用できるだけです。 アプリから別のアプリにコンポーネントをインポートする場合、元のアプリのコンポーネントに対する新しい更新は、以前にそれらのコンポーネントをインポートしたアプリには適用されません。 コンポーネント ライブラリを使用しているとき、ライブラリ内のコンポーネントの更新および公開を行うと、コンポーネントを更新するよう要求されます。

### <a name="create-a-new-component"></a>新しいコンポーネントの作成

1. [make.powerapps.com](https://make.powerapps.com) へサインインします。

1. **アプリ**を選択し、**空白の状態からキャンバス アプリを作成**を選択します。 

1. アプリ名を入力し、レイアウトを選択してから、**作成**を選択します。

1. **ツリー ビュー**で、**コンポーネント**を選択し、**新しいコンポーネント**を作成します。

    ![ツリー ビューを使用して新しいカスタム コンポーネントを作成する](./media/create-component/insert-new-component-treeview.png "ツリー ビューを使用して新しいカスタム コンポーネントを作成する")

1. 左側のナビゲーションで新しいコンポーネントを選択し、省略記号 (**...**) を選択して、**名前の変更**を選択します。 **MenuComponent** と名前を入力、または貼り付けます。

1. 右側のウィンドウで、コンポーネントの幅を **150**、高さを **250** に設定し、**新しいカスタム プロパティ**を選択します。 必要に応じて、高さと幅にその他の値を設定することもできます。

    ![新しいプロパティ](./media/create-component/new-property.png "新しいプロパティ")

1. **表示名**、**プロパティ名**、および**説明**ボックスに、テキストを*アイテム*として入力するか、または貼り付けます。

    ![表示名、プロパティ名、説明ボックス](./media/create-component/property-names.png "表示名、プロパティ名、説明ボックス")

    計算式を記述するとき、この名前でコンポーネントを参照するので、プロパティ名にスペースを含めないでください。 たとえば、**ComponentName.PropertyName** です。

    コンポーネントを選択するとき、右側のウィンドウの**プロパティ** タブに表示名が表示されます。 内容を示す表示名は、ユーザーおよびその他のメーカーがこのプロパティの目的を理解するのに役立ちます。 **説明**は、**プロパティ** タブのこのプロパティの表示名にカーソルを置いたとき、ツールヒントに表示されます。

1. **データ型**リストから**新規**を選択して、そして**作成**を選択します。

    ![プロパティのデータ型](./media/create-component/property-data-type.png "プロパティのデータ型")

    **アイテム** プロパティは、指定したデータ型に基づいて規定値に設定されます。 ニーズに合わせた値に設定できます。 **テーブル**または**レコード**のデータ型を指定した場合、コンポーネントに入力するデータ スキーマに一致するように**アイテム** プロパティの値を変更することがあります。 この場合、文字列のリストに変更します。

    右側のウィンドウの**プロパティ** タブのプロパティの名前を選択すると、数式バーでプロパティの値を設定できます。

    ![プロパティ タブのカスタム入力プロパティ](./media/create-component/properties-tab.png "プロパティ タブのカスタム入力プロパティ")

    次の図が示すように、右側のウィンドウの**詳細設定**タブでプロパティの値を編集することもできます。

1. コンポーネントの**アイテム** プロパティを次の式に設定します。

    ```powerapps-dot
    Table({Item:"SampleText"})
    ```

    ![計算式](./media/create-component/set-component-items.png "計算式")

1. コンポーネントで、空で垂直の**ギャラリー** コントロールを挿入し、**タイトル**としてプロパティ ウィンドウの**レイアウト**を選択します。

1. プロパティの一覧に**アイテム** プロパティが表示されていることを確認します (既定の動作)。 その後、そのプロパティの値を次の式に設定します。

    ```powerapps-dot
    MenuComponent.Items
    ```

    このように、**ギャラリー** コントロールの**アイテム** プロパティは、コンポーネントの**アイテム**入力プロパティを読み込み、それに依存します。

1. 任意 - **ギャラリー** コントロールの **BorderThickness** プロパティを **1** に、その **TemplateSize** プロパティを **50** に設定します。 必要に応じて、境界線の太さおよびテンプレート サイズの値をその他の値に更新することもできます。

### <a name="add-component-to-a-screen"></a>コンポーネントを画面に追加する

次に、コンポーネントを画面に追加し、コンポーネントが表示する文字列のテーブルを指定します。

1. 左側のナビゲーション バーで、画面の一覧を選択し、既定の画面を選択します。

    ![デフォルト画面](./media/create-component/default-screen.png "デフォルト画面")

1. **挿入**タブで、**コンポーネント** メニューを開いてから、**MenuComponent** を選択します。

    ![挿入​​](./media/create-component/insert.png "挿入​​")

    既定で、新しいコンポーネントの名前は **MenuComponent_1** になります。

1. **MenuComponent_1** の**アイテム** プロパティを、この数式に設定します。

    ```powerapps-dot
    Table({Item:"Home"}, {Item:"Admin"}, {Item:"About"}, {Item:"Help"})
    ```

    このインスタンスはこの図に似ていますが、各インスタンスのテキストおよびその他のプロパティをカスタマイズできます。

    ![最終ギャラリー](./media/create-component/menu-instance-new.png "最終ギャラリー")

### <a name="create-and-use-output-property"></a>出力プロパティの作成および使用

ここまでで、コンポーネントを作成し、アプリに追加しました。 次に、ユーザーがメニューで選択したアイテムを反映する出力プロパティを作成します。

1. コンポーネントの一覧を開き、**MenuComponent** を選択します。

1. 右側のウィンドウの**プロパティ** タブで、**新しいカスタム プロパティ**を選択します。

1. **表示名**、**プロパティ名**、および**説明**ボックスに、**選択済み**を入力するか、または貼り付けます。

1. **プロパティの型**の下で、**出力**を選択し、次に**作成**を選択します。

    ![出力としてのプロパティの型](./media/create-component/output-property-type.png "出力としてのプロパティの型")

1. **詳細設定**タブで、**選択済み**のプロパティの値をこの式に設定し、必要に応じてギャラリー名の数字を調整します。

    ```powerapps-dot
    Gallery1.Selected.Item
    ```

    ![詳細設定ウィンドウ](./media/create-component/advance.png "詳細ペイン")

1. アプリの既定の画面でラベルを追加し、**テキスト** プロパティをこの式に追加し、必要に応じてコンポーネント名の数字を調整します。

    ```powerapps-dot
    MenuComponent_1.Selected
    ```

    **MenuComponent_1** は既定のインスタンス名であり、コンポーネント定義の名前ではありません。 すべてのインスタンスの名前を変更できます。

1. Alt キーを押しながら、メニューの各項目を選択します。

    **ラベル** コントロールには、最近選択したメニュー項目が反映されます。

## <a name="import-and-export-components"></a>コンポーネントのインポートおよびエクスポート

> [!NOTE]
> この機能は廃止されます。 [コンポーネント ライブラリ](component-library.md) は、アプリ間でコンポーネントを再利用するのに推奨されている方法です。 コンポーネント ライブラリを使用する場合、アプリは使用するコンポーネントへの依存関係を保持します。 依存コンポーネントの更新が利用可能になると、アプリメーカーに通知されます。 したがって、新しい再利用可能なコンポーネントはすべて、その代わりにコンポーネント ライブラリ内で作成する必要があります。

### <a name="import-components-from-another-app"></a>その他のアプリからコンポーネントをインポートする

アプリから別のアプリに 1 つ以上のコンポーネントをインポートするには、**挿入**メニューから**コンポーネントのインポート**を選択し、**カスタム** ドロップダウン メニューを使用します。 または、左側のナビゲーション ツリー ビューの**コンポーネント**を使用します。

ダイアログ ボックスには、編集するためのアクセス許可があるコンポーネントを含む、すべてのアプリが一覧表示されます。 アプリを選択し、**インポート**を選択して、そのアプリ内にある最新公開バージョンのコンポーネントすべてをインポートします。 少なくとも 1 つのコンポーネントをインポートした後、コピーを編集して、不要なものをすべて削除できます。

![コンポーネントのインポート ダイアログ ボックス](./media/create-component/import-component-screen.png "コンポーネントのインポート ダイアログ ボックス")

アプリと既存のコンポーネントをローカルのファイルに保存し、インポートすることによりファイルを再利用できます。 ファイルを使用して、コンポーネントを別のアプリにインポートできます。

アプリに同じコンポーネントの変更したバージョンが含まれている場合、変更したバージョンを置き換えるか、インポートをキャンセルするか決定するように求められます。 

アプリでコンポーネントを作成した後、その他のアプリはインポートすることにより、このアプリからコンポーネントを使用できます。

### <a name="export-components-from-your-app"></a>アプリからコンポーネントをエクスポートする

コンポーネントをファイルにエクスポートし、別のアプリにインポートするためにダウンロードできます。

左側のナビゲーション ツリー ビューの**コンポーネント** セクションから**コンポーネントのエクスポート** オプションを選択します。

![コンポーネント ツリー ビューのエクスポート](./media/create-component/export-components-treeview.png "コンポーネント ツリー ビューのエクスポート")

代わりに、**挿入**メニューを使用し、**カスタム** ドロップダウン メニューを選択することもできます。

![エクスポート コンポーネントの挿入メニュー](./media/create-component/export-components-insert-menu.png "エクスポート コンポーネントの挿入メニュー")

**コンポーネントのエクスポート**を選択して、コンポーネントをファイルにダウンロードします。

![コンポーネントのダウンロード](./media/create-component/download-component.png "コンポーネントのダウンロード")

ダウンロードしたコンポーネント ファイルは、ファイル名の拡張子として *.msapp* を使用します。 

### <a name="import-components-from-exported-components-file"></a>エクスポートされたコンポーネント ファイルからコンポーネントをインポートする

エクスポートされたコンポーネント ファイルからコンポーネントをインポートするには、**挿入**メニューから**コンポーネントのインポート**を選択し、**カスタム** ドロップダウン メニューを使用するか、または左側のナビゲーションのツリー ビューの**コンポーネント**のいずれかを使用します。 コンポーネント ダイアログ ボックスから、その他のコンポーネントまたはアプリを選択する代わりに**ファイルのアップロード**を選択します。

![コンポーネント ファイルのインポート](./media/create-component/import-component-file.png "コンポーネント ファイルのインポート")

**開く**ダイアログ ボックスからコンポーネント ファイルの場所を参照し、**開く**を選択してアプリ内のコンポーネントをインポートします。

### <a name="import-components-from-exported-app"></a>エクスポートされたアプリからコンポーネントをインポートする

**ファイル** > **名前を付けて保存**オプションを使用して、アプリをローカルに保存することができます。

![アプリの保存](./media/create-component/save-app-locally.png "アプリの保存")

アプリを保存すると、ファイルからコンポーネントをインポートするのと同じ方法を使用して、このアプリのコンポーネントを再利用できます。 エクスポートされたコンポーネント ファイルからコンポーネントをインポートするの前のセクションの手順に従います。

## <a name="known-limitations"></a>既知の制限

- データソース、フォーム、およびデータ テーブルをコンポーネントと共に保存することはできません。
- コンポーネントのコレクションはサポートされていません。
- ギャラリーまたはフォームにコンポーネントを挿入することはできません。
- コンポーネントのマスター インスタンスはローカル マスターであり、アプリを対象の範囲としています。 マスター インスタンスを変更すると、アプリ内のコンポーネントのコピーのみに変更が反映されます。 その他のアプリのコピーは、コンポーネント ライブラリを再度インポートしない限り、元のまま維持されます。 これらのアプリのすべてのマスター インスタンスは自動的に検出され、更新されます。
- コンポーネントをインポートするときにメディア ファイルをパッケージ化することはできません。
- コンポーネントは、[**UpdateContext**](./functions/function-updatecontext.md) 関数はサポートしていませんが、[**Set**](functions/function-set.md) 関数を使用してコンポーネントの変数の作成および更新を行うことができます。 これらの変数のスコープはコンポーネントに制限されていますが、カスタム出力プロパティを通じてコンポーネントの外部から変数にアクセスすることができます。

## <a name="next-steps"></a>次の手順

再利用可能なコンポーネントのリポジトリを作成するために、[コンポーネント ライブラリ](component-library.md) を使用する方法を学びます。
