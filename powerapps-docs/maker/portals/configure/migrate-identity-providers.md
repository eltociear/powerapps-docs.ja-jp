---
title: Id プロバイダーの Azure AD B2C への移行 |MicrosoftDocs
description: Azure AD B2C に id プロバイダーを移行する方法について説明します。
author: sbmjais
manager: shujoshi
ms.service: powerapps
ms.topic: conceptual
ms.custom: ''
ms.date: 10/18/2019
ms.author: shjais
ms.reviewer: ''
ms.openlocfilehash: a57398d08e190140a3383aef29825f4c08e90363
ms.sourcegitcommit: 57b968b542fc43737330596d840d938f566e582a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/22/2019
ms.locfileid: "72978303"
---
# <a name="migrate-identity-providers-to-azure-ad-b2c"></a>Id プロバイダーを Azure AD B2C に移行する

ポータルでは、顧客が複数の認証システムをサポートできるように構成可能なセキュリティシステムがサポートされています。 このポータルには、OIDC、SAML、WS-FEDERATION などの標準プロトコルを使用して、外部 id プロバイダーとのフェデレーションに加えて、独自のローカル資格情報が含まれています。 今後は、Azure AD B2C id プロバイダーのみを認証に使用し、他の id プロバイダーを廃止することをお勧めします。 

## <a name="marking-an-identity-provider-as-deprecate"></a>Id プロバイダーを非推奨としてマークする

他の id プロバイダーを非推奨としてマークするようにポータルを構成し、ユーザーが Azure AD B2C id プロバイダーに移行できるようにすることができます。 

次のサイト設定は、id プロバイダーの廃止を制御するために使用されます。

| 名前  | Description  |
|--------|--------|
| 認証/登録/LocalLoginDeprecated | True または false の値。 True に設定すると、ローカルアカウントは非推奨としてマークされます。 非推奨のアカウントに移行するには、ポータルユーザーが必要です。 既定では、false に設定されています。 |
| Authentication/[protocol]/[provider]/非推奨  | True または false の値。 True に設定すると、特定のアカウントが非推奨としてマークされます。 非推奨のアカウントに移行するには、ポータルユーザーが必要です。 既定では、false に設定されています。 |
|||

ポータルユーザーがサインインしようとしたときに、少なくとも1つの id プロバイダーが非推奨としてマークされている場合は、非推奨のアカウントがページに表示されます。 次の例では、Microsoft アカウントは非推奨としてマークされています。

![非推奨のアカウントの例](../media/gdpr-deprecate-account.png "非推奨のアカウントの例")

従来の認証プロバイダーの画面上のテキストは、次のコンテンツスニペットを使用して変更できます。

| 名前                                               | 種類 | Value                         |
|----------------------------------------------------|------|-------------------------------|
| アカウント/サインイン/SignInExternalDeprecatedFormHeading | テキスト | 従来のアカウントでサインインする |
|||

> [!NOTE]
> 非推奨の id プロバイダーは、ユーザーがポータルの招待を登録または引き換えしたときに表示されません。

## <a name="migrating-a-deprecated-identity-provider-to-a-new-identity-provider"></a>非推奨の id プロバイダーの新しい id プロバイダーへの移行

ポータルユーザーが非推奨の id プロバイダーでサインインすると、アカウントの移行画面に、非推奨の id プロバイダーでサインインするためのメッセージが表示されます。 ユーザーが非推奨の id プロバイダーでサインインすると、そのユーザーアカウントが新しいプロバイダーに関連付けられます。

![アカウントの移行の例](../media/gdpr-account-migration.png "アカウントの移行の例")

アカウントの移行の画面に表示されるメッセージは、次のコンテンツスニペットを使用して変更できます。

| 名前                                         | 種類 | Value                                                                                                                                                                                                                |
|----------------------------------------------|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| アカウント/変換/PageTitle                 | テキスト | アカウントの移行                                                                                                                                                                                                    |
| アカウント/変換/PageCopy                  | 形式 | サポートされなくなったアカウントを使用してサインインしました。 このポータルを引き続き使用するには、別のアカウントに移行する必要があります。 次のボタンを選択して、新規または既存のサポートされているアカウントでサインインします。 |
| アカウント/変換/SignInExternalFormHeading | テキスト | サポートされているアカウントでサインインします。                                                                                                                                                                                     |
|||

ポータルでは、複数の id を1つの連絡先レコードに関連付けることができます。 複数のプロバイダーが非推奨とされた場合、ポータルユーザーは使用条件に複数回同意する必要があります。 非推奨の id プロバイダーを使用してユーザーがサインインするたびに、アカウントの移行プロセスが非推奨のプロバイダーごとに開始され、連絡先レコードは、アカウントの移行後に非推奨のプロバイダーに関連付けられます。

たとえば、ポータルでは、認証のために id プロバイダーとして Microsoft アカウント (MSA)、Google、および Facebook がサポートされています。 Google と Facebook を非推奨のプロバイダーとしてマークし、ポータルユーザーが認証用の id プロバイダーとして Google と Facebook のみを持っている場合、これら2つのプロバイダーのいずれかを使用してサインインしようとすると、ユーザーはアカウントの移行メッセージを受信します。 ユーザーが MSA を使用してサインインすると、ユーザーの連絡先レコードに MSA が追加されます。 これで、ユーザーは、サポートされている認証 id プロバイダーとしての MSA のみを持つようになりました。

ポータルユーザーが新しい id プロバイダーを選択し、その id が既に別の連絡先レコードと関連付けられている場合、エラーメッセージが表示されます。 次のコンテンツスニペットを使用して、エラーメッセージを構成できます。

| 名前                                                     | 種類 | Value                                                                                                                               |
|----------------------------------------------------------|------|-------------------------------------------------------------------------------------------------------------------------------------|
| アカウント/サインイン/AccountConversionIdentityUsedErrorHeading | テキスト | アカウントの変換エラー                                                                                                            |
| アカウント/サインイン/AccountConversionIdentityUsedErrorText    | 形式 | このアカウントは既に存在します。 ブラウザーを閉じてプロセスを再起動し、[アカウントの移行] ページで別のアカウントを選択します。 |
|||

## <a name="disabling-local-login"></a>ローカルログインの無効化

`Authentication/Registration/LocalLoginDeprecated` サイト設定を使用して、ローカルログインを無効にするようにポータルを構成できます。 他のユーザーがローカルの資格情報を使用してサインインしようとすると、アカウントの移行画面が、非推奨の id プロバイダーでサインインするための命令と共に表示されます。 アカウントを移行すると、そのユーザーのローカル資格情報は無効になります。

> [!NOTE]
> ローカルログインを非推奨としてマークした場合、ユーザーは新しいアカウントを登録できなくなります。

次のフィールドがポータルの連絡先レコードに追加され、ユーザーに対してローカルログインが無効になっているかどうかが示されます。
- **Local Login Disabled**: 連絡先がローカルアカウントを使用してポータルにサインインできなくなることを示します。 既定では、 **[いいえ]** に設定されています。 ユーザーのアカウントが非推奨の id プロバイダーに移行され、ローカルログインが無効になっている場合、このフィールドは **[はい]** に設定されます。

    ![ローカルログインが無効です](../media/local-login-disabled.png "ローカルログインが無効です")
