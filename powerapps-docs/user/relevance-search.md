---
title: 関連性検索 | MicrosoftDocs
ms.custom: ''
author: mduelae
manager: kvivek
ms.service: powerapps
ms.component: pa-user
ms.topic: conceptual
ms.date: 5/07/2020
ms.author: mduelae
ms.reviewer: ''
ms.assetid: ''
search.audienceType:
- enduser
search.app:
- PowerApps
- D365CE
ms.openlocfilehash: 1f1be4a3bc4e8afa582c061968e704ec122b8f70
ms.sourcegitcommit: c2d6af244332ebb34f3bdcf14b780b9a45b3f4a2
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2020
ms.locfileid: "3351045"
---
# <a name="using-relevance-search-to-search-for-records"></a>関連性検索を使用したレコードの検索

## <a name="what-is-relevance-search"></a>関連性検索とは?

関連性検索は、複数のエンティティ間で、すばやく包括的な結果を関連性の順に並び替えられた単一のリストに表示します。 検索パフォーマンスを促進するため、Common Data Service ([!INCLUDE[pn_Windows_Azure](../includes/pn-windows-azure.md)] で動作する) の外部にある専用の検索サービスを使用します。
  
関連性検索は、次の拡張機能と利点を提供します。  
<!--note from editor: Edits to these list items are suggested, so they can be parallel throughout this section.-->  
- 外部インデックスと [!INCLUDE[pn_azure_shortest](../includes/pn-azure-shortest.md)] 検索技術の使用により、パフォーマンスが向上します。  
  
- 検索語句のすべての単語が 1 つのフィールドに存在する必要がある簡易検索と比較して、エンティティ内の任意のフィールドで検索語句内のいずれかの単語と一致するものが検索されます。 

- **stream**、**streaming**、**streamed** などの単語の活用形を含むものと一致するものが検索されます。  
  
- 検索可能なすべてのエンティティの結果が、関連性によって並べ替えられた 1 つのリストで返されます。そのため、一致度が高いものほど、結果がリストの上部に表示されます。 検索する語句のより多くの単語が互いに近接している場合、一致の関連性はより高くなります。 検索語を検索する対象のテキストの量が小さくなるほど、関連性は高くなります。 たとえば、検索語が会社名と住所で見つかった場合、同じ語が長文の記事で互いに離れた場所で見つかった場合よりも、一致度は高くなります。
  
- 結果リストで一致項目が強調表示されます。 検索語句がレコード内の語句と一致すると、その語句が検索結果で太字、斜体のテキストで表示されます。 

    > [!NOTE]
    > - 言語でよく使用される特定の単語 (**the** や **a** など) は、レコードを一意に識別するのに役立たないため、検索時には無視されます。 このような単語は検索中に無視されるため、結果でも強調表示されません。
    > - 一致した語句だけが強調表示されるため、強調表示される語句は多くの場合、フィールド内のすべての値の一部として返されます。
    > - 強調表示された結果は、その一部である文のコンテキストで表示されます。 ピリオドは文の終わりと見なされるため、フィールドにピリオド (.) がある場合、これによって予期しない動作が発生する可能性があります。 この動作により、一致したフィールドの一部が切り捨てられた結果が得られる場合があります。

- メモ、電子メールの添付ファイル、または予定のテキストを含む Common Data Service に保存されているドキュメント内のテキストの検索結果が含まれます。 次のファイル形式が検索でサポートされています: PDF、Microsoft Office のドキュメント、HTML、XML、ZIP、EML、プレーン テキストと JSON。  
  
- 自分に共有されているレコードと自分が所有しているレコードを検索できます。  
  
  > [!NOTE]
  >  階層的なセキュリティ モデルはサポートされていません。 Common Data Service で行を表示できても、階層的なセキュリティを通してそれにアクセスできるため、関連性検索の結果を表示できません。  
  
- オプション セットと参照を検索することもできます。 たとえば、名前が**医薬品販売業**になっている小売店アカウントを検索するとします。 **医薬品販売業の小売業者**で検索すると、検索可能なオプション セットである業種フィールドとの一致があるため、結果を確認できます。

  > [!NOTE]
  > - 関連性検索はテキスト ベースであり、単一行テキスト、複数行テキスト、オプション セット、または検索のフィールドの種類のみを検索できます。 数値または日付データ型のフィールドでの検索をサポートしていません。
  
- 検索語句で構文を使用して、必要な結果を得ることができます。 たとえば、**car silver 2-door** と入力すると、検索結果では検索する語句のいずれも一致します。 **car+silver+2-door** と入力すると、3 単語すべてを含む一致のみが検索されます。 **car&#124;silver&#124;2-door** と入力すると、**car**、または **silver**、または **2-door**、または 3 つの単語すべてが含まれる結果が表示されます。 検索クエリで使用できる構文の詳細については、[Azure コグニティブ検索での単純なクエリ構文](https://docs.microsoft.com/rest/api/searchservice/simple-query-syntax-in-azure-search) を参照してください。<!--note from editor: The "More information:" pattern is good when there aren't any additional modifiers, which you have here. -->
  
  > [!NOTE]
  > 関連性検索は、クエリの条件のいずれか (すべてではなく) に一致することを要求するように構成されています。これにより、期待とは異なる結果になる場合があります。 これは特に、ブール演算子がクエリに含まれているときに当てはまります。<!--note from editor: Via style guide, it's always capital "Boolean," and it's "might" instead of "may.-->

## <a name="enable-relevance-search"></a>関連性検索を有効にする

関連性検索は既定で無効になっています。 管理者は組織に対してこれを有効にする必要があります。これにより、組織内のすべてのユーザーがそれを使用できるようになります。 関連性検索が有効になってから、ご使用のアプリで関連性検索の結果が表示されるようになるまで、組織の規模によっては、最大 1 時間以上待つ必要がある場合があります。 インデックス付きデータの小さな変更がシステムで表示されるようになるまで最大で 15 分かかることがあります。

## <a name="switch-between-relevance-search-and-categorized-search"></a>関連性検索とカテゴリ別検索を切り替える

組織で両方の検索オプション (関連性検索とカテゴリ別検索) をオンにしている場合は、2 つを切り替えることができます。

1. 検索の種類を切り替えるには、ナビゲーション バーで **検索** を選択します。

2. 左側で、ドロップダウン メニューを選択して **関連性検索** または **カテゴリ別検索** に切り替えます。

   > [!div class="mx-imgBorder"]
   > ![関連性とカテゴリ別検索の切り替え](media/switch-global-search.png "関連性検索とカテゴリ別検索を切り替える") 
    
## <a name="set-a-default-search-experience"></a>既定の検索エクスペリエンスを設定する

組織で両方の検索オプションを有効にしている場合は、個人用の設定で既定の検索エクスペリエンスを選択できます。

1. ページの右上隅にある **設定** を選択し、**個人用設定** を選択します。  
  
   > [!div class="mx-imgBorder"]
   > ![個人設定](media/personalization-settings.png "個人設定")  

2. **全般** タブの **既定の検索エクスペリエンスを選択する** セクションで、**既定の検索エクスペリエンス** に既定のエクスペリエンスを選択します。 

   > [!div class="mx-imgBorder"]
   > ![既定の検索エクスペリエンスを選択する](media/default-search-experience.png "既定の検索エクスペリエンスを選択する")  

## <a name="start-a-search"></a>検索を開始する 
 
1.  上部のナビゲーション バーから、**検索** を選択します。  

    > [!div class="mx-imgBorder"]
    > ![グローバル検索 ボタン](media/global-search-button.png "グローバル検索") 
  
2.  検索ボックスに検索語を入力し、**検索** を選択します。

    > [!div class="mx-imgBorder"]
    > ![関連性検索 ボックス](media/relevance-search-box.png "関連性検索 ボックス")   

## <a name="filter-records-with-facets"></a>ファセットを持つレコードのフィルター処理

Common Data Service では、ファセットおよびフィルターを使用して、検索結果を絞ることができるようになりました。 ファセットとフィルターにより、検索文字列を繰り返し絞り込むことなく、現在の検索用語を詳細表示と検討が可能です。

ファセットは、左端のペインで使用できます。 検索を実行した直後に、次のグローバル ファセットは 4 つの共通フィールドで使用できます:  
  
-   レコードの種類  
  
-   所有者  
  
-   [作成日]  
  
-   [修正日]  
  
### <a name="record-type-facets"></a>ソース レコードのファセット

特定のエンティティに対して検索結果を絞り込むには、**レコードの種類**セクションでエンティティを選択します。  
 
  > [!div class="mx-imgBorder"]
  > ![検索結果を絞り込むレコードの種類のファセット](media/relevance-search-record-type-facet.png "検索結果を絞り込むために使用されるレコードの種類のファセット")  
  
特定のレコードの種類でフィルター処理すると、選択したレコードに関連付けられた活動およびメモを検索結果に含めることができます。 その場合は、**関連するメモと活動**チェック ボックスをオンにします。 活動やメモは最上位の結果として表示されます。
 
  > [!div class="mx-imgBorder"]
  > ![検索結果のレコードの種類に関連するメモおよび活動を追加する](media/relevance-search-record-type-facet-related-notes-activities.png "検索結果のレコードの種類に関連するメモおよび活動を追加する")  
  
メールの添付ファイルや予定のエンティティに存在する検索結果は、メールまたは予定のいずれかの親レコードの検索結果で表示されます。  
  
レコードの種類によって検索を調整すると、ファセットのスコープが選択したエンティティへ切り替わり、エンティティ固有の 4 つまでのファセットが表示されます。 たとえば、取引先企業エンティティを選択すると、グローバルのファセットに加え、**取引先責任者**ファセットが表示されます。  
  
**個人用オプションの設定**ダイアログ ボックスでは、システム管理者または顧客がユーザーに対して使用できるようにしたものから他のファセットを選択できます。 ユーザーの設定が既定の設定より優先します。 [!INCLUDE[proc_more_information](../includes/proc-more-information.md)] [検索に対してファセットとフィルターを構成する](#BKMK_ConfigureFacets)  
  
### <a name="text-based-facets"></a>テキストベース ファセット

すべての検索、オプション セット、およびレコードの種類はテキスト ベース ファセットです。 たとえば、テキスト ベース ファセットの所有者は、フィールドの値と対応する数の一覧で構成されています。  
 
  > [!div class="mx-imgBorder"]
  > ![関連性検索のテキスト ベース ファセット](media/relevance-search-text-based-facets.png "関連性検索のテキスト ベース型ファセット")  
  
これらのファセットでのフィルターは数によって降順に並べ替えられます。 上位 4 つのファセットの値が既定で表示されます。 5 つ以上のファセット値がある場合は、**詳細を表示** リンクが表示されます。選択すると、リストを展開して最大 15 個のファセット値を表示することができます。 各値を選択し、選択した値を持つフィールドがあるレコードのみを表示するように検索結果をフィルター処理をします。 たとえば、**原 達也** を選択すると、所有者が原 達也であるすべてのレコードが検索結果に表示されます。 検索またはオプション セットのファセット値を選択すると、検索結果では、指定した値が含まれているレコードのみを表示するようにフィルターされます。  
  
### <a name="date-and-time-facets"></a>日付と時刻のファセット

他ファセットと同様に、特定の時刻に対して検索結果をフィルター処理し、表示するには、日付と時刻のファセットを使用できます。 一連の値を選択するには、スライダーをドラッグするか、または縦の列の 1 つを選択します。  
 
  > [!div class="mx-imgBorder"]
  > ![関連性検索の日付と時刻のファセット](media/relevance-search-date-time-facets.png "関連性検索の日付と時刻のファセット")  

<a name="BKMK_ConfigureFacets"></a>

## <a name="configure-facets-and-filters"></a>ファセットとフィルターの構成
  
> [!NOTE]
>  システム カスタマイザーは、すべてのエンティティに対する既定エクスペリエンスを設定できますが、ユーザーは自身のファセットとフィルターを設定できます。  
  
1. 右上隅にある **設定** を選択し、**個人用設定** を選択します。  
  
   > [!div class="mx-imgBorder"]
   > ![個人設定](media/personalization-settings.png "個人設定")
  
2. **概要**タブの**既定の検索エクスペリエンスを選択する**セクションで、**ファセットおよびフィルター**フィールドに対して、**構成**を選択します。  

   > [!div class="mx-imgBorder"]
   > ![ファセットおよびフィルターの構成](media/configure-facets-filters.png "ファセットおよびフィルターの構成")  
  
3. **ファセットとフィルターの構成**ダイアログ ボックスで、エンティティで表示するファセットを指定します。 システム管理者またはカスタマイザーは、すべてのエンティティに対する既定エクスペリエンスを設定できますが、ユーザーは自身のファセットとフィルターをここで設定できます。  
  
   - **エンティティの選択**ドロップダウン リストで、ファセットを構成するためのエンティティを選択します。 このドロップダウン リストには関連性検索用に有効であるエンティティのみが含まれます。  
  
   - 選択されたエンティティの場合は、4 つまでのファセット フィールドを選択します。 既定では、選択したエンティティ用の **簡易検索** ビューで、最初の 4 つの "ファセット可能な” フィールドがリストに選択されます。 いつでも、ファセットとして 4 つのフィールドのみを使用できます。  
  
   複数のエンティティを一度に更新できます。 **OK** を選択すると、設定したすべてのエンティティの変更が保存されます。 事前に設定されたエンティティを既定の動作に戻すには、**既定**を選択します。  
  
   > [!NOTE]
   > - システム カスタマイザーによりフィールドが削除されるまたは検索不可能とされ、そのフィールドのファセットを保存した場合は、そのフィールドはファセットとして表示されることはありません。  
   >   -   既定のソリューションに存在し、システム カスタマイザーによって検索可能に設定されているフィールドのみが表示されます。  
