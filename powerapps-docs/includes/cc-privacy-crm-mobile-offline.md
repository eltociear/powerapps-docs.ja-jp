Dynamics 365 mobile offline を有効にすると、オフラインで使用できるエンティティに基づいて、Azure クラウドを使用している SQL Azure データベースに Dynamics 365 (online) データがダウンロードされます。 ユーザーが、オフライン機能を備えたモバイル アプリから Azure クラウド サービスに接続すると、SQL Azure データベースからモバイル デバイス上のローカル データベースにデータがダウンロードされます。 Azure クラウド上の SQL Azure データベースと、オフライン機能を備えた Dynamics 365 モバイル アプリの間のデータ転送は、セキュリティで保護された SSL 接続経由で行われます。 最終的に、顧客データは SQL Azure データベースとモバイル デバイスに保存されます。  
  
 管理者は、セキュリティ ロールと Dynamics 365 Mobile プロファイル カスタマイズを使用することで、組織のユーザーが Microsoft Dynamics 365 Mobile Offline Application をオフラインにできるかどうかを決定します。 Dynamics 365 管理者は、[Mobile Offline 設定] ダイアログ ボックスの [同期フィルター] 設定を使用して、オフライン同期を介してどのエンティティがダウンロードされるかを構成できます。  
  
 ユーザーのデバイスに保存されたデータをコントロールするのは、Microsoft ではなくお客様であることにご注意ください。 管理者は、抽出可能なデータを (ユーザー セキュリティ ロールのレベルまたはエンティティのレベルで) 完全にコントロールできます。 ただし、データ抽出後、データは Dynamics 365 Online によって提供されるセキュリティ境界を離れます。  
  
 Mobile offline 機能に関連する Azure コンポーネントとサービスの一覧を以下に示します。  
  
 **メモ:** その他の Azure サービス内容については [Microsoft Azure セキュリティ センター](https://azure.microsoft.com/support/trust-center/) を参照してください。  
  
 **クラウド サービス (Web ロール)**  
  
 Mobile Offline は 2 つのクラウド サービスを活用します。1 つはプロビジョニング用、もう 1 つはデータ同期用です。  
  
 プロビジョニング サービスには、プロビジョニングやプロビジョニング解除など、Dynamics 365 で発生するさまざまなイベントに関するメッセージをサービス バス (SB) キューから読み取る、1 つの Web ロールがあります。 次に、組織のデータベースを作成または削除し、データ同期 SB キューに定期的な作業アイテム (メッセージ) を送信することで、それらのメッセージを処理します。 このプロセスでは、CSCFG ファイルまたは Dynamics 365 SW API のいずれかから構成データを読み取り、書き込みます。  
  
 データ同期サービスは 2 つの Web ロールがあります。 1 つは、ステージング データベースのスキーマおよびデータと、Dynamics 365 組織のメタデータおよびデータとの同期を維持します。もう 1 つは、同期サーバーを実行し、クライアントの同期要求を処理するための Web ロールです。 最初の Web ロールは、さまざまな組織のデータ同期 SB キューのメッセージを処理し、Dynamics 365 に接続して、メタデータやデータの変更を (ステージング データベースにコミットする前に) 取得します。 また、システムに出入りする組織と各組織のクライアント モデルを同期サーバーに構成するジョブも実行します。 もう一方の Web ロールは、同期サーバー (アンマネージ コード) を実行して、管理エンドポイントと同期エンドポイントをホストします。 管理エンドポイントは、もう一方の Web ロールによって、構成データを送信するために使用されます。 同期エンドポイントは、外部クライアント (Dynamics 365 Mobile Application) によって、データ同期を実行するために使用されます。プロビジョニング サービスと同様、これらのロールは両方とも、CSCFG ファイルまたは Dynamics 365 SW API の構成データの読み取りと書き込みを行います。  
  
 **キュー**  
  
 Mobile Offline は、Azure キューを Dynamics 365 と Azure 間のメッセージ交換に使用します。 Azure キューは、クラウド サービスで処理される作業アイテムを管理するために使用されます。 各メッセージは、組織 ID、データを同期する対象であるエンティティの名前、組織の OData エンドポイントの接続文字列などの情報を保存します。  
  
 **SQL Database**  
  
 Mobile Offline は Azure SQL Storage を使用して以下の情報を保存します。  
  
-   Dynamics 365 組織から複製された、クライアントの同期要求を処理するためのデータ。  
  
-   組織のデータベース接続文字列などの構成データ。  
  
 **Storage**  
  
 Mobile Offline は、Azure Blob Storage を使用して、クラウド サービスで生成されたログとトレースを保存します。  
  
 **Active Directory サービス**  
  
 Mobile Offline は、Azure Active Directory サービスを使用して、Dynamics 365、SW API、Azure Management API などの他のサービスに対する認証を行います。  
  
 **Azure DNS**  
  
 Mobile Offline は Azure DNS を使用して、組織名に基づいてクライアント要求を適切なクラウド サービス エンドポイントにリダイレクトします。  
  
 **Azure Virtual Network**  
  
 Azure Virtual Network (VNet) は、クラウドにあるユーザー独自のネットワークを表します。 Dynamics 365 製品チームは、Azure ネットワーク設定を管理し、DHCP アドレス ブロック、DNS 設定、セキュリティ ポリシー、ルーティングを定義できます。  
  
 **Azure Load Balancer**  
  
 Azure Load Balancer は、アプリケーションに高可用性と優れたネットワーク パフォーマンスを提供します。 これは、ロード バランサー セットで定義されているクラウド サービスや仮想マシンの正常なサービス インスタンス間で着信トラフィックを分散する、第 4 層 (TCP、UDP) のロード バランサーです。 これを使って、展開に含まれるエンドポイントの負荷分散を行います。